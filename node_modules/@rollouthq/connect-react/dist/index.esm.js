var Ze=Object.defineProperty;var Ko=(e,t)=>{for(var r in t)Ze(e,r,{get:t[r],enumerable:!0})};var We={};Ko(We,{AutomationCreator:()=>go,AutomationEditor:()=>bo,AutomationsManager:()=>ba,BlueprintActivator:()=>_o,BlueprintsList:()=>ho,BlueprintsManager:()=>Ba,MyAutomations:()=>xo,MyBlueprints:()=>Ao,PoweredByRollout:()=>$a,RolloutConnectProvider:()=>tl});import Fe,{useState as Hi}from"react";import{useMutation as Xi}from"@rollouthq/api-client-react";import w,{useCallback as fo,useMemo as Bt}from"react";import{useState as ji}from"react";import{useSpinDelay as Qi}from"spin-delay";import{useQuery as zi,useTRPCContext as Ui}from"@rollouthq/api-client-react";import{inputDefToZodObject as Pe}from"@rollouthq/common";import Ur,{useLayoutEffect as qr}from"react";import{useEffect as Wr,useState as Zr}from"react";import{isVariable as Yr,z as Uo}from"@rollouthq/common";var ot={};Ko(ot,{BooleanInput:()=>Lr,DropdownInput:()=>Cr,FindBy:()=>hr,MultiSelectInput:()=>Br,NoInputsComponent:()=>Mr,RichTextInput:()=>Tr});import W,{useEffect as Bo,useState as Eo}from"react";import{isVariable as fr,ROLLOUTHQ_VARIABLE_PREFIX as gr}from"@rollouthq/common";import ro from"react";import{createContext as Ye}from"@rollouthq/ui";var[wo,N]=Ye({name:"AppComponentRenderer"});import{useCallback as tr}from"react";import{get as or,getPath as Oo,set as er}from"ts-object-path";import{inputDefToZodObject as rr}from"@rollouthq/common";import{getPath as He}from"ts-object-path";import{ZodObject as Xe,ZodOptional as Je,ZodRecord as Ge}from"zod";function ko(e,t){let r=He(t);return eo(e,r)}function eo(e,t){let r=t.slice(1),n=e instanceof Je?e.unwrap():e;if(n instanceof Xe){let o=n.shape[t[0]];return t.length>1?eo(o,r):o}if(n instanceof Ge){let o=n.valueSchema;return t.length>1?eo(o,r):o}throw console.error("getByPath: unhandled prop type:",n),new Error("getByPath: unhandled prop type")}function R(e){let t=N(),{inputParams:r,setInputParams:n,importedData:o,credentialId:i,isBlueprintActivation:a}=t,s=Oo(e),l=or(r,e),p=tr(v=>{let P=structuredClone(r);er(P,e,v),n(P)},[n,r]),d="inputParamsSchema"in o?o.inputParamsSchema:rr(o.inputParamDefs),u=ko(d,e),f=u.isOptional(),m=u.description,g=(m==null?void 0:m.label)??ir(s),y=(m==null?void 0:m.description)??"",_=(m==null?void 0:m.isCredentialDependent)??!1,C=d.safeParse(r),k=_&&i==null&&!a?void 0:nr(C,e);return{value:l,setValue:p,isOptional:f,label:g,description:y,isCredentialDependent:_,error:k,path:s}}function nr(e,t){let r=Oo(t);if(!e.success)return e.error.issues.find(n=>n.path.join(".")===r.join("."))}function ir(e){return e.map(t=>ar(t.toString())).join(" ")}function ar(e){let t=e.replace(/([A-Z\d])/g,r=>` ${r.toLowerCase()}`);return`${t[0].toUpperCase()}${t.slice(1)}`}import pt from"react";import{dataAttr as lr}from"@rollouthq/ui";function Mt(e){let{label:t,description:r,error:n,isRequired:o,children:i}=e;return pt.createElement("div",{className:"rollout-form-control"},t&&pt.createElement("div",{className:"rollout-form-control__label"},t,o&&pt.createElement("span",{className:"rollout-form-control__required-hint"}," ","(required)")),r&&pt.createElement("div",{className:"rollout-form-control__description"},r),pt.createElement("div",{className:"rollout-form-control__input","data-error":lr(!!n)},i),n&&pt.createElement("div",{className:"rollout-form-control__error"},n))}import{Flex as sr,UserForm as pr}from"@rollouthq/ui";function q(e){let{bind:t,children:r,description:n,error:o,isRequired:i=!1}=e,{credentialId:a,isBlueprintActivation:s=!1}=N(),l=R(t),p=l.isCredentialDependent&&a==null&&!s;if(s&&!l.isCredentialDependent)return null;function d(){return p?ro.createElement(sr,{css:{alignItems:"center",padding:"8px",backgroundColor:"$surfaceSecondary",borderRadius:"4px",color:"$grayMedium",fontSize:"13px",fontWeight:500}},ro.createElement(pr,{css:{marginRight:"6px"}}),"Input provided by user when automation is activated"):r}let u=e.label??"";return ro.createElement(Mt,{description:n,error:o,isRequired:i,label:u},d())}import mr,{createElement as dr}from"react";import ur from"react";function No(e){return ur.createElement("div",{className:"rollout-card"},e.children)}function S(e){let{defaultField:t,ctx:r,renderer:n}=e;return n==null||n===!0?mr.createElement(t,null):n===!1?null:n({...r,createElement:dr,Card:No})}import{createContext as cr}from"@rollouthq/ui";var[Vt,F]=cr({name:"Form"});import{ComboBox as $o,ComboBoxItem as no,ComboBoxSection as io,createContext as yr}from"@rollouthq/ui";var[br,xr]=yr({name:"DropdownInput"});function Cr(e){let r=R(e.bind).path.join("."),{renderInputParams:n}=N(),o=S({defaultField:Ro,renderer:n==null?void 0:n[r],ctx:{InputParamField:Ro}});return W.createElement(br,{value:e},o)}function Ro(e){var b;let t=xr(),{bind:r,dependencies:n,fetchOptions:o,allowOnlyVariables:i}=t,a=R(r),{value:s,setValue:l}=a,p=t.label??a.label,d=t.description??a.description,u=t.placeholder||"Select option",[f,m]=Eo([]),[g,y]=Eo(!1),{shouldShowErrors:_}=F(),{variables:C,disabled:k}=N(),v=t.isDisabled||k||n!=null&&n.every(Boolean)!==!0||e.disabled;Bo(()=>{async function x(){y(!0);let Q=await o();m(Q),y(!1)}!i&&!v&&x()},[JSON.stringify(n),i,v]),Bo(()=>{i&&s&&!fr(s)&&l(void 0)},[i,s]);let P=C.map(x=>({id:`${gr}${x.id}`,name:`@${x.label}`})),K=[...P,...f],O=K.find(x=>x.id===s),L=W.createElement($o,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:v,defaultItems:P,menuTrigger:"focus",selectedOption:O,isLoading:g,inputPlaceholder:u,onSelectionChange:x=>l(x==null?void 0:x.id)},W.createElement(io,{title:"Variables"},P.map(x=>W.createElement(no,{key:x.id},x.name)))),j=W.createElement($o,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:v,defaultItems:K,menuTrigger:"focus",selectedOption:O,key:s,isLoading:g,inputPlaceholder:u,onSelectionChange:x=>l(x==null?void 0:x.id)},W.createElement(io,{title:"Options"},f.map(x=>W.createElement(no,{key:x.id},x.name))),W.createElement(io,{title:"Variables"},P.map(x=>W.createElement(no,{key:x.id},x.name)))),V=i?L:j;return W.createElement(q,{bind:r,label:p,description:d,error:_?(b=a.error)==null?void 0:b.message:void 0,isRequired:!a.isOptional},V)}import ut,{useEffect as _r}from"react";function hr(e){var f;let{filterInput:t,filterValueInput:r,selectInput:n}=e,{bind:o}=e,i=R(o),{shouldShowErrors:a}=F(),{value:s,setValue:l,isOptional:p}=i,d=e.label??i.label,u=e.description??i.description;return _r(()=>{s==null&&l("filter")},[s]),ut.createElement(ut.Fragment,null,ut.createElement(q,{bind:o,label:d,isRequired:!p,description:u,error:a?(f=i.error)==null?void 0:f.message:void 0},ut.createElement("div",{className:"rollout-form-control-find__container"},ut.createElement("button",{type:"button","aria-label":"Search from list button",className:s=="select"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>l("select")},"From list"),ut.createElement("button",{type:"button","aria-label":"Search by filter button",className:s=="filter"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>l("filter")},"From search"))),s=="filter"&&t,s=="filter"&&r,s=="select"&&n)}import jt,{useCallback as Ar,useMemo as Ir}from"react";import{resolveMentions as vr}from"@rollouthq/common";import{RichEditor as Pr,createContext as Fr}from"@rollouthq/ui";var[Sr,Dr]=Fr({name:"RichTextInput"});function Tr(e){let r=R(e.bind).path.join("."),{renderInputParams:n}=N(),o=S({defaultField:Lo,renderer:n==null?void 0:n[r],ctx:{InputParamField:Lo}});return jt.createElement(Sr,{value:e},o)}function Lo(e){var y;let t=Dr(),{bind:r,inputProps:n,placeholder:o}=t,i=R(r),a=t.label??i.label,s=t.description??i.description,l=N(),{variables:p}=l,{shouldShowErrors:d}=F(),u=l.disabled||t.disabled||e.disabled,f=!i.isOptional||t.isRequired,m=Ar(_=>{i.setValue(_??void 0)},[i.setValue]),g=Ir(()=>i.value&&vr(i.value,p),[i.value,p]);return jt.createElement(q,{bind:r,label:a,isRequired:f,description:s,error:d?(y=i.error)==null?void 0:y.message:void 0},jt.createElement("div",{className:"rollout-rich-text-input"},jt.createElement(Pr,{value:g??null,setValue:m,placeholder:o,formattingEnabled:!1,linksEnabled:!1,mentionVariables:p,isDisabled:u,...n})))}import ao,{useEffect as Kr,useState as Mo}from"react";import{createContext as wr,MultiSelect as kr}from"@rollouthq/ui";var[Or,Nr]=wr({name:"MultiSelectInput"});function Br(e){let r=R(e.bind).path.join("."),{renderInputParams:n}=N(),o=S({defaultField:Vo,renderer:n==null?void 0:n[r],ctx:{InputParamField:Vo}});return ao.createElement(Or,{value:e},o)}function Vo(e){var k;let t=Nr(),{bind:r,dependencies:n,fetchOptions:o,placeholder:i}=t,a=R(r),s=N(),{value:l,setValue:p}=a,d=t.label??a.label,u=t.description??a.description,f=s.disabled||e.disabled||!(n!=null&&n.every(Boolean)),[m,g]=Mo([]),[y,_]=Mo(!1),{shouldShowErrors:C}=F();return Kr(()=>{async function v(){if(_(!0),!f){let P=await o();g(P)}_(!1)}v()},[f]),ao.createElement(q,{bind:r,label:d,description:u,error:C?(k=a.error)==null?void 0:k.message:void 0},ao.createElement(kr,{label:d,isDisabled:f,items:m,isLoading:y,inputPlaceholder:i||"Select option",onSelectionChange:v=>{p(v.map(P=>P.id).join(", "))},value:l}))}import lo from"react";import{createContext as Er}from"@rollouthq/ui";var[$r,Rr]=Er({name:"BooleanInput"});function Lr(e){let r=R(e.bind).path.join("."),{renderInputParams:n}=N(),o=S({defaultField:jo,renderer:n==null?void 0:n[r],ctx:{InputParamField:jo}});return lo.createElement($r,{value:e},o)}function jo(e){var f;let t=Rr(),{bind:r}=t,n=R(r),{shouldShowErrors:o}=F(),a=N().disabled||e.disabled,{value:s,setValue:l,isOptional:p}=n,d=t.label??n.label,u=t.description??n.description;return lo.createElement(q,{bind:r,label:d,isRequired:!p,description:u,error:o?(f=n.error)==null?void 0:f.message:void 0},lo.createElement("input",{type:"checkbox",checked:s,disabled:a,onChange:m=>l(m.target.checked)}))}import Qo from"react";var Mr=()=>Qo.createElement(Qo.Fragment,null,"No inputs");import{useMemo as Vr}from"react";import jr from"react";import{createContext as Qr}from"@rollouthq/ui";var[zr,mt]=Qr({name:"RolloutApiBaseUrlContext"});function zo(e){let{children:t,...r}=e,n=Vr(()=>r,Object.values(r));return jr.createElement(zr,{value:n},t)}var qo=typeof document>"u"?Wr:qr;function dt(e){let{apiBaseUrl:t}=mt(),[r,n]=Zr();return qo(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:Uo},react:Ur,["@rollouthq/common"]:{z:Uo,isVariable:Yr},["@rollouthq/connect-react/components/action-inputs"]:ot}})},[]),qo(()=>{if(e==null)return n(void 0);if(!e.appKey||!e.triggerKey)return;let o=`${t}/connect-react/${e.appKey}/triggers/${e.triggerKey}.js`;new Function("path","return import(path)")(o).then(a=>{n(a)})},[JSON.stringify(e)]),r}import{useMemo as Hr}from"react";import Xr from"react";import{createContext as Jr}from"@rollouthq/ui";var[Gr,Wo]=Jr({name:"RolloutAllowedAppsContextProvider"});function Zo(e){let{children:t,...r}=e,n=Hr(()=>r,Object.values(r));return Xr.createElement(Gr,{value:n},t)}import{useEffect as tn}from"react";import{useLazyQuery as on}from"@rollouthq/api-client-react";function Yo(e){let t=on("apps.actions");return tn(()=>{(e==null?void 0:e.appKey)!=null&&t.fetch({appKey:e.appKey})},[e==null?void 0:e.appKey]),t}import{useQuery as en}from"@rollouthq/api-client-react";function Ho(e){let{allowedApps:t}=e;return en(["apps.list"],{select:t!=null?r=>r.filter(n=>t.includes(n.key)):void 0})}import sn from"assert";import{useEffect as pn}from"react";import{useQuery as Jo}from"@rollouthq/api-client-react/";import rn from"popup-centered";import{useCallback as nn,useEffect as an,useState as Xo}from"react";import{useTRPCContext as ln}from"@rollouthq/api-client-react";function Qt(e){let[t,r]=Xo(null),[n,o]=Xo(),{client:i}=ln();an(()=>{function s(l){var d;let p=l.data._rollouthq;p!=null&&p.ok?(p==null?void 0:p.type)==="credential-added"&&p.appKey===n&&p.credentialId!=null&&((d=e.onCredentialAdded)==null||d.call(e,p.credentialId)):p!=null&&p.error&&r(p.error)}return window.addEventListener("message",s,!1),()=>{window.removeEventListener("message",s)}},[n]);let a=nn(async s=>{o(s.appKey),r(null);try{let{url:l}=await i.query("oauth.getURL",{appKey:s.appKey,customParams:s.customParams});rn(l,"",{width:800,height:800})}catch{r("Woops! Something went wrong linking account.")}},[]);return{oauthPopupError:t,openOAuthPopup:a}}function Ft(e){let{appKey:t,setCredentialId:r}=e,{openOAuthPopup:n}=Qt({onCredentialAdded:l=>{r(l),a.refetch()}}),i=Jo(["apps.authInfo",{appKey:t}],{enabled:t!=null}).data,a=Jo(["apps.credentials",{appKey:t,authType:i==null?void 0:i.type}],{enabled:t!=null&&i!=null}),s=a.data;pn(()=>{if(!(i==null||s==null)){if(i.type==="none"||i.type==="apiKey"&&i.singleCredentialOnly){let l=s.length>0;return sn(l,"No credentials found!"),r(s[0].id)}(i.type==="oauth1"||i.type==="oauth2")&&i.singleCredentialOnly&&(s.length===0?n({appKey:t}):r(s[0].id))}},[i,s])}import{dataAttr as qi,useToggle as Wi,Spinner as Zi,useAsyncMemo as Yi}from"@rollouthq/ui";import Z,{useMemo as _n}from"react";import un from"react";import{st as mn}from"@rollouthq/ui";function D(e){let{apiBaseUrl:t}=mt(),{appKey:r,css:n}=e,o=`${t}/connect-react/${r}/icon`;return un.createElement(mn.img,{key:r,src:o,css:{width:"1em",...n}})}import Go,{useMemo as dn}from"react";import{useQuery as cn}from"@rollouthq/api-client-react";import{createContext as fn}from"@rollouthq/ui/";var[gn,zt]=fn({name:"RolloutEndUserProvider"});function te(e){var n;let r=(n=cn(["end-users.getInfo"]).data)==null?void 0:n.appKey;return r==null?null:Go.createElement(yn,{appKey:r},e.children)}function yn(e){let{appKey:t}=e,r=dn(()=>({appKey:t}),[t]);return Go.createElement(gn,{value:r},e.children)}import{createProxy as bn,getPath as xn}from"ts-object-path";function J(e,t){if(e.success)return;let r=bn(),n=xn(t(r));return e.error.issues.find(o=>o.path.join(".")===n.join("."))}import{Center as hn,ComboBox as An,ComboBoxItem as In,FormControl as vn}from"@rollouthq/ui";import{createContext as Cn}from"@rollouthq/ui";var[oe,B]=Cn({name:"AutomationForm"});function Pn(e){var u,f;let{appKey:t}=zt(),{apps:r,data:n,setData:o,validation:i}=B(),{action:a}=n,s=J(i,m=>m.action),l=_n(()=>{var m;return((m=r.data)==null?void 0:m.filter(g=>g.hasActions))??[]},[r.data]),p=(u=r.data)==null?void 0:u.find(m=>m.key===(a==null?void 0:a.appKey)),{shouldShowErrors:d}=F();return Z.createElement("div",{className:"rollout-automation-form__action-app"},Z.createElement("div",{style:{display:"none"}},(f=r.data)==null?void 0:f.map(m=>Z.createElement(D,{key:m.key,appKey:m.key}))),Z.createElement(vn,{error:d?s==null?void 0:s.message:void 0},Z.createElement(An,{"aria-label":"Action dropdown",defaultItems:l,selectedOption:p,isDisabled:e.isDisabled,icon:p==null?void 0:Z.createElement(D,{appKey:p.key}),inputPlaceholder:"Select app",menuTrigger:"focus",onSelectionChange:m=>o(g=>{var P;if(m==null)return{...g,action:void 0};let y=m.key===t,_=((P=g.trigger)==null?void 0:P.appKey)===t,v=y&&_||!y&&!_;return{...g,action:{appKey:m.key,inputParams:{}},trigger:v?void 0:g.trigger}})},m=>Z.createElement(In,{key:m._comboboxKey,textValue:m.name},Z.createElement(hn,{className:"rollout-listbox__option-icon"},Z.createElement(D,{appKey:m.key})),m.name))))}function St(e){return Z.createElement(Pn,{isDisabled:e.disabled})}import se,{useCallback as Un}from"react";import{useQuery as qn}from"@rollouthq/api-client-react/";import wn from"assert";import M,{useEffect as kn,useMemo as On,useRef as ne,useState as so}from"react";import{useMutation as Nn,useQuery as Bn}from"@rollouthq/api-client-react";import et,{useEffect as Dn,useState as Ut}from"react";import{useMutation as Tn}from"@rollouthq/api-client-react";import{Spinner as Kn}from"@rollouthq/ui";import Dt,{forwardRef as Fn}from"react";import{TextField as Sn}from"@rollouthq/ui";var ee=Fn((e,t)=>{let{isTestingConnection:r,value:n,onChange:o}=e,{infoHTML:i,label:a,placeholder:s}=e.definition;return Dt.createElement("div",null,Dt.createElement("label",{className:"rollout-automation-form__api-token-input-label"},a),i!=null&&Dt.createElement("div",{dangerouslySetInnerHTML:{__html:i},className:"rollout-automation-form__api-token-input-info"}),Dt.createElement("div",null,Dt.createElement(Sn,{ref:t,className:"rollout-automation-form__api-token-input","aria-label":"Token input text field",isDisabled:r,placeholder:s,value:n,onChange:o})))});function re(e){let{appKey:t,saveApiToken:r,authType:n,firstApiTokenInput:o,openOAuthPopup:i,closeModal:a,savingApiToken:s}=e,[l,p]=Ut({}),[d,u]=Ut(!1),[f,m]=Ut(!1),[g,y]=Ut(!1),_=Tn("credentials.test-connection"),C=k();Dn(()=>{d&&(u(!1),m(!1))},[l]);function k(){return"customParams"in n&&n.customParams!=null?n.customParams.every(L=>(l==null?void 0:l[L.key])!=null):!0}function v(){y(!0),_.mutate({appKey:t,apiToken:l},{onSuccess:L=>{u(!0),m(L),y(!1)}})}function P(){var L;if(n==null)return null;if("customParams"in n)return(L=n.customParams)==null?void 0:L.map((j,V)=>et.createElement(ee,{key:V,ref:V===0?o:void 0,definition:j,value:(l==null?void 0:l[j.key])??"",onChange:b=>p({...l,[j.key]:b}),isTestingConnection:g}))}let K=()=>{i({appKey:t,customParams:l}),y(!1),a()},O=()=>{f&&l!=null?r(l):v()};return et.createElement("div",{className:"rollout-automation-form__api-token-input-container"},P(),(n==null?void 0:n.type)==="apiKey"?et.createElement("div",{className:"rollout-automation-form__api-token-apitoken-button-container"},et.createElement("button",{type:"button","aria-label":"Save button",disabled:!C||g||s,className:`rollout-button--primary ${g?"rollout-automation-form__api-token-test-button":"rollout-automation-form__api-token-save-button"}`,onClick:O},(g||s)&&et.createElement(Kn,null),d&&f?"Save":g?"Testing Connection ...":"Test Connection"),d&&et.createElement("span",{className:"rollout-automation-form__api-token-connection-result"},f?"\u2705 Connection Success":"\u26A0\uFE0F Woops! Check your credentials")):et.createElement("button",{type:"button","aria-label":"Save button",disabled:!C||g||s,className:"rollout-button--primary",onClick:K},"Add account"))}import{Avatar as ie,Center as En,ComboBox as $n,ComboBoxItem as ae,dataAttr as Rn,FormControl as Ln,GoogleSignIn as Mn,GreenPlus as Vn,Person as jn,Plus as Qn}from"@rollouthq/ui";var le={id:"ADD_OPTION",label:"Add new account",avatar:void 0,icon:M.createElement(Qn,null)};function zn(e){let{isDisabled:t,appKey:r,setCredentialId:n,credentialId:o,authInfoQuery:i,error:a}=e,{shouldShowErrors:s}=F(),[l,p]=so(!1),[d,u]=so(!1),f=Nn("credentials.add-api-token"),m=Bn(["apps.credentials",{appKey:r}]),g=ne(null),y=ne(null),[_,C]=so(!1),{openOAuthPopup:k,oauthPopupError:v}=Qt({onCredentialAdded:b=>{n(b),m.refetch()}});kn(()=>{p(v!=null)},[v]);let P=On(()=>[...m.data??[],le],[m.data]),K=P.find(b=>b.id===o),O=_?M.createElement(Vn,null):K&&K.avatar!=null?M.createElement(ie,{src:K.avatar,name:K.label,alt:K.label}):M.createElement(jn,null);function L(b){b!=null&&(u(!0),f.mutate({appKey:r,credential:b},{onSuccess:x=>{var Q;C(!1),m.refetch(),(Q=y.current)==null||Q.blur(),n(x),u(!1)},onError:()=>u(!1)}))}let j=P,V=j.find(b=>b.id===o);return M.createElement("div",{className:"rollout-automation-form__credentials","data-avatar":!0,"data-selected":Rn((K==null?void 0:K.avatar)!=null)},M.createElement(Ln,{error:s?a==null?void 0:a.message:void 0},M.createElement($n,{"aria-label":"Account dropdown",customRef:y,defaultItems:j,selectedOption:V,menuTrigger:"focus",icon:O,isDisabled:t,isLoading:m.isFetching||i.isFetching,inputPlaceholder:_?"Connect new account":"Select account",onSelectionChange:b=>{if(b==null)return n(void 0);let x=i.data,Q=b===le;if(wn(x!=null,"No app auth info"),Q){(x.type==="oauth1"||x.type==="oauth2")&&(x.customParams!=null?(C(!0),setTimeout(()=>{var Y;return(Y=g.current)==null?void 0:Y.focus()})):k({appKey:r})),x.type==="apiKey"&&(C(!0),setTimeout(()=>{var Y;return(Y=g.current)==null?void 0:Y.focus()})),p(!1);return}p(!1),C(!1),n(b.id)}},b=>(r==="gmail"||r==="googleCalendar"||r==="googleDocs"||r==="googleSheets")&&b.id==="ADD_OPTION"?M.createElement(ae,{key:b._comboboxKey,textValue:b.label},M.createElement(Mn,null)):M.createElement(ae,{key:b._comboboxKey,textValue:b.label},M.createElement(En,{className:"rollout-listbox__option-icon"},M.createElement(ie,{"aria-label":"Option icon",src:b.avatar,name:"icon"in b?null:b.label,alt:b.label,icon:"icon"in b?b.icon:void 0})),b.label))),l&&M.createElement("div",{className:"rollout-automation-form-oauth__error__message"},v??"Oops! Couldn't link that account."),_&&i.data!=null&&M.createElement(re,{appKey:r,authType:i.data,saveApiToken:L,savingApiToken:d,credentialId:o,firstApiTokenInput:g,openOAuthPopup:k,closeModal:()=>C(!1)}))}function rt(e){let{appKey:t,authInfoQuery:r,credentialId:n,error:o,setCredentialId:i,isDisabled:a}=e,s=r.data;return s==null||(s.type==="oauth1"||s.type==="oauth2"||s.type==="apiKey")&&s.singleCredentialOnly||s.type==="none"?null:M.createElement(zn,{appKey:t,authInfoQuery:r,credentialId:n,setCredentialId:i,error:o,isDisabled:a})}function Wn(e){let{appKey:t,credentialId:r,setCredentialId:n,error:o,isDisabled:i}=e,a=qn(["apps.authInfo",{appKey:t}]);return a.data==null?null:se.createElement(rt,{appKey:t,authInfoQuery:a,credentialId:r,setCredentialId:n,error:o,isDisabled:i})}function Tt(e){let{data:t,setData:r,validation:n}=B(),{action:o}=t,i=Un(a=>r(s=>({...s,action:{...s.action,credentialId:a}})),[]);return(o==null?void 0:o.actionKey)==null?null:se.createElement(Wn,{appKey:o.appKey,credentialId:o.credentialId,setCredentialId:i,error:n.success?void 0:n.error.issues.find(a=>a.path.join(".")==="action.credentialId"),isDisabled:e.disabled})}import nt from"react";import{Center as Zn,ComboBox as Yn,ComboBoxItem as Hn,FormControl as Xn}from"@rollouthq/ui";function Jn(e){var f;let{data:t,setData:r,actions:n,validation:o}=B(),{shouldShowErrors:i,setShouldShowErrors:a}=F(),l=(()=>o.success?null:o.error.issues.find(m=>m.path.join(".")==="action.actionKey"))(),p=t.action!=null?nt.createElement(D,{appKey:t.action.appKey}):void 0,d=n.data??[],u=(f=n.data)==null?void 0:f.find(m=>{var g;return m.key===((g=t.action)==null?void 0:g.actionKey)});return nt.createElement("div",{className:"rollout-automation-form__action-action"},nt.createElement(Xn,{error:i?l==null?void 0:l.message:void 0},nt.createElement(Yn,{"aria-label":"Action dropdown",defaultItems:d,selectedOption:u,isDisabled:e.isDisabled,icon:p,isLoading:n.isLoading,inputPlaceholder:"Select action",menuTrigger:"focus",onSelectionChange:m=>(a(!1),r(g=>({...g,action:{...g.action,actionKey:m==null?void 0:m.key,inputParams:{}}})))},m=>nt.createElement(Hn,{key:m._comboboxKey,textValue:m.name},nt.createElement(Zn,{className:"rollout-listbox__option-icon"},p),m.name))))}function Kt(e){return nt.createElement(Jn,{isDisabled:e.disabled})}import hi from"assert";import gt from"react";import xi from"assert";import ft,{useCallback as Ci}from"react";import{useTRPCContext as _i}from"@rollouthq/api-client-react";import kt from"react";import{createProxy as ui}from"ts-object-path";import{useQuery as mi}from"@rollouthq/api-client-react";import wt from"react";import{unreachableCase as ai}from"ts-assert-unreachable";import Gn from"react";import{TextField as ti}from"@rollouthq/ui/";function pe(e){return Gn.createElement(ti,{className:"rollout-input",value:e.value??"",onChange:e.setValue,isDisabled:e.isDisabled})}import ue from"react";import{resolveMentions as oi}from"@rollouthq/common";import{RichEditor as ei}from"@rollouthq/ui";function me(e){let t=e.value&&oi(e.value,e.variables);return ue.createElement("div",{className:"rollout-rich-text-input"},ue.createElement(ei,{value:t??null,setValue:r=>e.setValue(r??void 0),formattingEnabled:!1,linksEnabled:!1,mentionVariables:e.variables,isDisabled:e.isDisabled}))}import{createContext as li}from"@rollouthq/ui/";import de from"react";import{ComboBox as ri,ComboBoxItem as ni,useAsyncMemo as ii}from"@rollouthq/ui";function ce(e){let{def:t,value:r,setValue:n,getDynamicOptions:o}=e,a=ii(async()=>{var l;return((l=t.dropdownConfiguration)==null?void 0:l.type)==="static"?t.dropdownConfiguration.staticOptions.map(p=>({key:p,label:p})):await o({inputKey:t.key})},[JSON.stringify(t.dropdownConfiguration)]).value??[],s=a.find(l=>l.key===r);return de.createElement(ri,{defaultItems:a,selectedOption:s,menuTrigger:"focus",icon:null,inputPlaceholder:"Select option",onSelectionChange:l=>{n(l==null?void 0:l.key)},isDisabled:e.isDisabled},l=>de.createElement(ni,{key:l._comboboxKey,textValue:l.label},l.label))}var[si,pi]=li({name:"InputDefRenderer"});function ge(e){let{renderInputParams:t}=N(),r=S({defaultField:fe,renderer:t==null?void 0:t[e.def.key],ctx:{InputParamField:fe}});return wt.createElement(si,{value:e},r)}function fe(e){let t=pi(),{def:r,value:n,setValue:o,variables:i,getDynamicOptions:a}=t;function s(){if(r.type==="plainText")return wt.createElement(pe,{def:r,value:n,setValue:o,isDisabled:e.disabled});if(r.type==="dropdown")return wt.createElement(ce,{def:r,value:n,setValue:o,getDynamicOptions:a,isDisabled:e.disabled});if(r.type==="string")return wt.createElement(me,{def:r,value:n,setValue:o,variables:i,isDisabled:e.disabled});ai(r)}return wt.createElement(Mt,{label:r.label,isRequired:!0,error:void 0},s())}var di=ui();function it(e){let{api:t,credentialId:r,inputParams:n,setInputParams:o,importedData:i,variables:a,getDynamicOptions:s}=e;return kt.createElement(wo,{value:e},"Component"in i?kt.createElement(i.Component,{b:di,credentialId:r,inputParams:n,setInputParams:o,api:t,useQuery:mi,inputComponents:ot}):kt.createElement(kt.Fragment,null,i.inputParamDefs.map(l=>kt.createElement(ge,{key:l.key,def:l,value:n[l.key],setValue:p=>o({...n,[l.key]:p}),variables:a,getDynamicOptions:s}))))}import ci,{useLayoutEffect as fi}from"react";import{useEffect as gi,useState as yi}from"react";import{isVariable as bi,z as ye}from"@rollouthq/common";var be=typeof document>"u"?gi:fi;function ct(e){let{actionRef:t}=e,{apiBaseUrl:r}=mt(),[n,o]=yi();return be(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:ye},react:ci,["@rollouthq/common"]:{z:ye,isVariable:bi},["@rollouthq/connect-react/components/action-inputs"]:ot}})},[]),be(()=>{if(t!=null){let{appKey:i,actionKey:a}=t;if(!i||!a)return;let s=`${r}/connect-react/${i}/actions/${a}.js`;new Function("path","return import(path)")(s).then(p=>o(p))}},[t==null?void 0:t.appKey,t==null?void 0:t.actionKey]),n}function xe(){return ft.createElement("div",{className:"rollout-automation-form__action-inputs"},ft.createElement("div",null,ft.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),ft.createElement(po,null)))}function po(){var l;let{client:e}=_i(),{data:t,setData:r,variables:n,renderFields:o}=B(),i=t.action,a=ct({actionRef:t.action}),s=Ci(p=>{r(d=>({...d,action:{...d.action,inputParams:p}}))},[r]);return a==null||i.credentialId==null?null:(xi(typeof(o==null?void 0:o.action)!="function"&&typeof(o==null?void 0:o.action)!="boolean"),ft.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},ft.createElement(it,{api:e,credentialId:i.credentialId,inputParams:i.inputParams,setInputParams:s,renderInputParams:(l=o==null?void 0:o.action)==null?void 0:l.inputParams,importedData:a,variables:n,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}})))}function uo(){var a,s,l;let{data:e,renderFields:t}=B(),{action:r}=e;hi(typeof(t==null?void 0:t.action)!="function"&&typeof(t==null?void 0:t.action)!="boolean");let n=S({defaultField:St,renderer:(a=t==null?void 0:t.action)==null?void 0:a.appKey,ctx:{ActionAppKeyField:St}}),o=S({defaultField:Kt,renderer:(s=t==null?void 0:t.action)==null?void 0:s.actionKey,ctx:{ActionKeyField:Kt}}),i=S({defaultField:Tt,renderer:(l=t==null?void 0:t.action)==null?void 0:l.credentialId,ctx:{ActionCredentialIdField:Tt}});return gt.createElement(gt.Fragment,null,gt.createElement("div",{className:"rollout-automation-form__action"},gt.createElement("div",{className:"rollout-automation-form__label"},"Select action"),gt.createElement("div",{className:"rollout-automation-form__helper-text"},"This is what your automation will do when triggered"),n,o,i),(r==null?void 0:r.actionKey)!=null&&r.credentialId!=null&&gt.createElement(xe,null))}import $i from"assert";import G,{useCallback as he,useMemo as Ri}from"react";import{useTRPCContext as Li}from"@rollouthq/api-client-react";import H from"react";import{useQuery as Ai}from"@rollouthq/api-client-react";import{Center as Ii,ComboBox as vi,ComboBoxItem as Pi,FormControl as Fi,Rocket as Si}from"@rollouthq/ui";function Di(e){let{appKey:t}=zt(),{data:r,setData:n,validation:o}=B(),{trigger:i}=r,a=Ai(["triggers.apps"]),{shouldShowErrors:s}=F(),l=J(o,u=>u.trigger),p=a.data??[],d=p==null?void 0:p.find(u=>u.key===(i==null?void 0:i.appKey));return H.createElement("div",{className:"rollout-automation-form__trigger-app"},H.createElement(Fi,{error:s?l==null?void 0:l.message:void 0},H.createElement(vi,{"aria-label":"Trigger app dropdown",defaultItems:p,selectedOption:d,menuTrigger:"focus",icon:i==null?H.createElement(Si,null):H.createElement(D,{appKey:i.appKey}),isDisabled:e.isDisabled,inputPlaceholder:"Select app",onSelectionChange:u=>n(f=>{var k;if(u==null)return{...f,trigger:void 0};let m=u.key===t,g=((k=f.action)==null?void 0:k.appKey)===t,C=m&&g||!m&&!g;return{...f,trigger:{appKey:u.key,inputParams:{}},action:C?void 0:f.action}})},u=>H.createElement(Pi,{key:u._comboboxKey,textValue:u.name},H.createElement(Ii,{className:"rollout-listbox__option-icon"},H.createElement(D,{appKey:u.key})),u.name))))}function Ot(e){return H.createElement(Di,{isDisabled:e.disabled})}import X from"react";import{useQuery as Ti}from"@rollouthq/api-client-react";import{Center as Ki,ComboBox as wi,ComboBoxItem as ki,FormControl as Oi,Rocket as Ce}from"@rollouthq/ui";function Ni(e){let{isDisabled:t}=e,{shouldShowErrors:r}=F(),{validation:n,data:o,setData:i}=B(),{trigger:a}=o,s=Ti(["apps.triggers",{appKey:a==null?void 0:a.appKey}],{enabled:(a==null?void 0:a.appKey)!=null}),l=J(n,u=>u.trigger.triggerKey),p=s.data??[],d=p.find(u=>u.key===(a==null?void 0:a.triggerKey));return X.createElement(Oi,{error:r?l==null?void 0:l.message:void 0},X.createElement(wi,{"aria-label":"Trigger dropdown",defaultItems:p,selectedOption:d,menuTrigger:"focus",isDisabled:t||s.isLoading,icon:(a==null?void 0:a.appKey)==null?X.createElement(Ce,null):X.createElement(D,{appKey:a==null?void 0:a.appKey}),inputPlaceholder:"Select trigger",onSelectionChange:u=>i(f=>({...f,trigger:{...f.trigger,triggerKey:u==null?void 0:u.key,inputParams:{}}}))},u=>X.createElement(ki,{key:u._comboboxKey,textValue:u.name},X.createElement(Ki,{className:"rollout-listbox__option-icon"},(a==null?void 0:a.appKey)==null?X.createElement(Ce,null):X.createElement(D,{appKey:a==null?void 0:a.appKey})),u.name)))}function Nt(e){return X.createElement(Ni,{isDisabled:e.disabled})}import Bi from"react";import{useQuery as Ei}from"@rollouthq/api-client-react";function _e(e){let{appKey:t,credentialId:r,setCredentialId:n,error:o,isDisabled:i}=e,a=Ei(["apps.authInfo",{appKey:t}]);return a.data==null?null:Bi.createElement(rt,{appKey:t,authInfoQuery:a,credentialId:r,setCredentialId:n,error:o,isDisabled:i})}function mo(){var m,g,y;let{client:e}=Li(),{data:t,setData:r,renderFields:n,validation:o}=B(),{trigger:i}=t,a=dt(i),s=he(_=>{r(C=>({...C,trigger:{...C.trigger,inputParams:_}}))},[r]),l=he(_=>r(C=>({...C,trigger:{...C.trigger,credentialId:_}})),[r]),p=Ri(()=>[],[]);$i(typeof(n==null?void 0:n.trigger)!="function"&&typeof(n==null?void 0:n.trigger)!="boolean");let d=S({defaultField:Ot,renderer:(m=n==null?void 0:n.trigger)==null?void 0:m.appKey,ctx:{TriggerAppKeyField:Ot}}),u=S({defaultField:Nt,renderer:(g=n==null?void 0:n.trigger)==null?void 0:g.triggerKey,ctx:{TriggerKeyField:Nt}}),f=a&&("inputParamsSchema"in a?Object.keys(a.inputParamsSchema.shape).length>0:a.inputParamDefs.length>0);return G.createElement("div",{className:"rollout-automation-form__trigger"},G.createElement("div",{className:"rollout-automation-form__label"},"Select trigger"),G.createElement("div",{className:"rollout-automation-form__helper-text"},"This is the event that will kick off your action"),d,G.createElement("div",{className:"rollout-automation-form__trigger-trigger"},u),(i==null?void 0:i.triggerKey)!=null&&G.createElement(_e,{appKey:i.appKey,credentialId:i.credentialId,setCredentialId:l,error:o.success?void 0:o.error.issues.find(_=>_.path.join(".")==="trigger.credentialId")}),(i==null?void 0:i.credentialId)!=null&&f&&G.createElement("div",{className:"rollout-automation-form__trigger-inputs"},G.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},G.createElement(it,{api:e,credentialId:i.credentialId,inputParams:i.inputParams,setInputParams:s,renderInputParams:(y=n==null?void 0:n.trigger)==null?void 0:y.inputParams,importedData:a,variables:p,getDynamicOptions:({inputKey:_})=>e.query("triggers.getTriggerInputOptions",{triggerKey:i.triggerKey,inputKey:_})}))))}import Ae from"react";import{TextField as Mi}from"@rollouthq/ui";function Vi(e){let{disabled:t=!1}=e,{data:r,setData:n,validation:o}=B(),{shouldShowErrors:i}=F(),a=J(o,s=>s.name)!=null;return Ae.createElement(Mi,{"aria-label":"Automation Name Input",className:"rollout-automation-form__name",placeholder:"Give your automation a name",isDisabled:t,value:r.name??"",validationState:i&&a?"invalid":"valid",onChange:s=>n(l=>({...l,name:s}))})}function co(e){return Ae.createElement(Vi,{...e})}import{useMemo as Ie}from"react";import{z}from"zod";var yt=z.object({name:z.string().min(1),trigger:z.object({appKey:z.string(),triggerKey:z.string(),credentialId:z.string(),inputParams:z.object({})}),action:z.object({appKey:z.string(),actionKey:z.string(),credentialId:z.string(),inputParams:z.object({})})});function ve(e){let{data:t,actionInputParamsSchema:r,triggerInputParamsSchema:n}=e,o=Ie(()=>yt.extend({trigger:yt.shape.trigger.extend({inputParams:n}),action:yt.shape.action.extend({inputParams:r})}),[n,r]);return Ie(()=>o.safeParse(t),[t,o])}function qt(e){var ht,At,It,vt,Pt;let{data:t,isSaving:r,onSave:n,onCancel:o,onUpdate:i,onDelete:a,mode:s,renderFields:l}=e,[p,d]=ji(!1),[u,f]=Wi(),{client:m}=Ui(),y=(It=zi(["apps.triggers",{appKey:(ht=t.trigger)==null?void 0:ht.appKey}],{enabled:((At=t.trigger)==null?void 0:At.appKey)!=null}).data)==null?void 0:It.find($=>{var E;return $.key===((E=t.trigger)==null?void 0:E.triggerKey)}),_=Yi(async()=>{var $,E,c;return y==null?[]:y.payloadConfiguration.type==="static"?y.payloadConfiguration.staticSchema:await m.query("triggers.getPayloadSchema",{appKey:($=t.trigger)==null?void 0:$.appKey,triggerKey:(E=t.trigger)==null?void 0:E.triggerKey,inputParams:(c=t.trigger)==null?void 0:c.inputParams})},[JSON.stringify(y==null?void 0:y.payloadConfiguration),JSON.stringify(t.trigger)]),C=Bt(()=>(_.value??[]).map($=>({id:$.key,label:$.label,type:"string"})),[_.value]),{allowedApps:k}=Wo(),v=Ho({allowedApps:k}),P=Yo(t.action),K=ct({actionRef:t.action}),O=dt(t.trigger),L=Bt(()=>O==null?yt.shape.action.shape.inputParams:"inputParamsSchema"in O?O.inputParamsSchema:Pe(O.inputParamDefs),[O]),j=Bt(()=>K==null?yt.shape.action.shape.inputParams:"inputParamsSchema"in K?K.inputParamsSchema:Pe(K.inputParamDefs),[K]),V=ve({data:t,triggerInputParamsSchema:L,actionInputParamsSchema:j}),b=fo($=>i(E=>{var Do,To;let c=$(E),A=((Do=E.trigger)==null?void 0:Do.triggerKey)!==((To=c.trigger)==null?void 0:To.triggerKey),Lt=c.action==null?void 0:{...c.action,inputParams:A?{}:c.action.inputParams};return{...c,action:Lt}}),[i]),x=Bt(()=>({data:t,apps:v,actions:P,validation:V,variables:C,setData:b,renderFields:l}),[t,v,P,V,C,b,l]),Q=Bt(()=>({shouldShowErrors:p,setShouldShowErrors:d}),[p,d]),Y=fo($=>b(E=>({...E,trigger:{...E.trigger,credentialId:$}})),[b]),Jt=fo($=>b(E=>({...E,action:{...E.action,credentialId:$}})),[b]);Ft({appKey:(vt=t.trigger)==null?void 0:vt.appKey,setCredentialId:Y}),Ft({appKey:(Pt=t.action)==null?void 0:Pt.appKey,setCredentialId:Jt});let $t=v.data==null,Gt=Qi($t,{delay:500,minDuration:200});if(v.failureCount>0)return w.createElement("div",{className:"rollout-automations-list__error-msg"},"Woops! Something went wrong fetching automations.");if($t||Gt)return w.createElement("div",{className:"rollout__loading_spinner_container"},w.createElement(Zi,{className:"rollout__loading_spinner"}));let to=S({defaultField:co,renderer:l==null?void 0:l.name,ctx:{NameField:co}}),oo=typeof(l==null?void 0:l.trigger)=="object"?w.createElement(mo,null):S({defaultField:mo,renderer:l==null?void 0:l.trigger,ctx:{TriggerAppKeyField:Ot,TriggerKeyField:Nt}}),Rt=typeof(l==null?void 0:l.action)=="object"?w.createElement(uo,null):S({defaultField:uo,renderer:l==null?void 0:l.action,ctx:{ActionAppKeyField:St,ActionKeyField:Kt,ActionCredentialIdField:Tt,ActionInputFields:po}});return w.createElement(Vt,{value:Q},w.createElement(oe,{value:x},w.createElement("div",{className:"rollout-automation-form"},w.createElement("div",{className:"rollout-automation-form__header"},to),w.createElement("div",{className:"rollout-automation-form__content"},oo,Rt),w.createElement("div",{className:"rollout-automation-form__buttons"},w.createElement("button",{type:"button","aria-label":"Save button",className:"rollout-button--primary rollout-automation-form__submit","data-loading":qi(r),onClick:()=>{d(!0),V.success?n(V.data):console.error(V.error)}},r?"Saving...":"Save"),o!=null&&w.createElement("button",{type:"button","aria-label":"Cancel button",className:"rollout-button--secondary rollout-automation-form__cancel",onClick:()=>o()},"Cancel"),s!=="create"&&w.createElement("div",{className:"rollout-automation-form__delete"},u&&w.createElement("div",{className:"rollout-automation-form-delete__confirm-dialog"},w.createElement("div",{className:"rollout-automation-form__delete-confirm-text"},"Are you sure you want to delete this automation?"),w.createElement("div",{className:"rollout-automation-form__delete-confirm-buttons"},w.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:f,className:"rollout-button--secondary rollout-automation-form__delete-cancel"},"No, cancel"),w.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:a,className:"rollout-button--danger rollout-automation-form__delete-confirm"},"Yes, delete"))),w.createElement("button",{type:"button","aria-label":"Delete button",className:"rollout-button--danger rollout-automations-form-delete__trigger",onClick:f},"Delete"))))))}function go(e){let{onAutomationCreated:t,onBeforeAutomationCreate:r,onCancel:n,prefilled:o,renderFields:i}=e,a=Xi("automations.create"),[s,l]=Hi(()=>{var u,f;let d={};return o==null||(o.name&&(d.name=o.name),((u=o.trigger)==null?void 0:u.appKey)!=null&&(d.trigger={...o.trigger,appKey:o.trigger.appKey,inputParams:o.trigger.inputParams??{}}),((f=o.action)==null?void 0:f.appKey)!=null&&(d.action={...o.action,appKey:o.action.appKey,inputParams:o.action.inputParams??{}})),d}),p=async d=>{let u=await(r==null?void 0:r({automationData:d}));if(u===!1)return;let f=u===!0||u===void 0?d:u.automationData,m=await a.mutateAsync(f);t({automation:m})};return Fe.createElement("div",{className:"rollout-automation-creator"},Fe.createElement(qt,{mode:"create",data:s,renderFields:i,onUpdate:l,isSaving:a.isLoading,onSave:p,onCancel:n}))}import yo,{useState as Ji}from"react";import{useMutation as Se,useQuery as Gi,useTRPCContext as ta}from"@rollouthq/api-client-react";function bo(e){let{automationId:t,onAutomationDeleted:r,onAutomationUpdated:n,onCancel:o,renderFields:i}=e,{invalidateQueries:a}=ta(),s=Se("automations.delete",{onSuccess:()=>a(["automations.list"])}),[l,p]=Ji({}),d=Gi(["automations.get",{automationId:t}],{onSuccess(g){g!=null&&p({name:g.name,action:g.action,trigger:g.trigger})}}),u=Se("automations.update");if(d.isLoading)return null;if(d.data==null)return yo.createElement("div",{className:"rollout-automations-editor__not-found"},"Automation not found");let f=async g=>{let y=await u.mutateAsync({id:t,automationData:{name:g.name,action:g.action,trigger:g.trigger}});n==null||n(y)},m=()=>{s.mutate({id:d.data.id},{onSuccess:()=>{r==null||r()}})};return yo.createElement("div",{className:"rollout-automation-editor"},yo.createElement(qt,{mode:"edit",data:l,renderFields:i,onUpdate:p,isSaving:u.isLoading,onSave:f,onDelete:m,onCancel:o}))}import at,{useState as ga}from"react";import bt,{useEffect as pa,useState as ua}from"react";import{useMutation as ma,useQuery as da,useTRPCContext as ca}from"@rollouthq/api-client-react";import{matchSorter as De}from"match-sorter";import I,{useEffect as oa,useState as we}from"react";import{isChildofInteractiveElement as ea,Center as Te,Search as ra,TextField as na,Spinner as ia,dataAttr as Ke}from"@rollouthq/ui";import{useToggle as aa,Trash as la}from"@rollouthq/ui";function ke(e){let{automations:t,isLoading:r=!1,isDeleting:n=!1,onEditAutomation:o,onDeleteAutomation:i}=e,[a,s]=we(""),l=De(t,a,{keys:["name","action.app.name"],threshold:De.rankings.ACRONYM}),p=l.length===0;return I.createElement("div",{className:"rollout-automations-list__container"},I.createElement("div",{className:"rollout-automations-list__search-input__group"},I.createElement("div",{className:"rollout-automations-list__search-input__left-element"},I.createElement(ra,null)),I.createElement(na,{"aria-label":"Search automations text field",placeholder:"Search automations",value:a,onChange:s,className:"rollout-automations-list__search-input"})),r&&I.createElement("div",{className:"rollout__loading_spinner_container"},I.createElement(ia,{className:"rollout__loading_spinner"})),!r&&p&&I.createElement("div",{className:"rollout-automations-list__empty-msg"},"No automations found"),I.createElement("div",{className:"rollout-automations-list__list"},l.map(d=>I.createElement(sa,{key:d.id,automation:d,onEdit:()=>o(d),onDelete:()=>i(d),isDeleting:n}))))}function sa(e){let{automation:t,onEdit:r,onDelete:n,isDeleting:o}=e,[i,a]=aa(),[s,l]=we(!1);oa(()=>{!o&&s&&l(!1)},[o]);let p=i&&I.createElement("div",{className:"rollout-automations-list-item__options__content",onMouseLeave:()=>{i&&a()}},I.createElement("span",null,"Really delete?"),I.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:()=>{n(),l(!0)},className:"rollout-automations-list-item__options__delete-item-btn"},"Delete"),I.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:a,className:"rollout-automations-list-item__options__cancel-item-btn"},"Cancel"));return I.createElement("div",{className:"rollout-automations-list__item-wrapper","data-deleting":Ke(s)},p,I.createElement("div",{className:"rollout-automations-list__item",role:"group","data-open":Ke(i),onClick:d=>{ea(d.target)||r()}},I.createElement("div",{className:"rollout-automations-list-item__header"},I.createElement("div",{className:"rollout-automations-list-item__icons"},I.createElement(Te,{className:"rollout-automations-list-item__trigger"},I.createElement(D,{appKey:t.trigger.appKey})),I.createElement(Te,{className:"rollout-automations-list-item__action"},I.createElement(D,{appKey:t.action.appKey}))),I.createElement("div",{role:"button",className:"rollout-automations-list-item__options__trigger",onClick:a},I.createElement(la,null))),I.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}import{Plus as fa}from"@rollouthq/ui";function xo(e){let{onEditAutomation:t,onCreateAutomation:r,filter:n}=e,{invalidateQueries:o}=ca(),[i,a]=ua(()=>[]),s=da(["automations.list"]);pa(()=>{s.data!=null&&(n!=null?a(s.data.filter(p=>{try{return n(p)}catch(d){return console.error(d),!1}})):a(s.data))},[s.data,n]);let l=ma("automations.delete",{onSuccess:()=>o(["automations.list"])});return bt.createElement("div",null,bt.createElement("div",{className:"rollout-automations-list__header"},bt.createElement("span",{className:"rollout-automations-list__header-title"},"My automations"),bt.createElement("button",{type:"button","aria-label":"New automation button",className:"rollout-automations-list__new-btn",onClick:()=>r()},bt.createElement(fa,null),"New")),bt.createElement(ke,{automations:i??[],isLoading:s.isFetching,isDeleting:l.isLoading,onDeleteAutomation:p=>l.mutate({id:p.id}),onEditAutomation:t}))}import{ArrowBack as ya}from"@rollouthq/ui";function ba(e){let{onAutomationCreated:t,onBeforeAutomationCreate:r,prefilled:n,filter:o,renderFields:i}=e,[a,s]=ga({mode:"LIST"});return at.createElement("div",{className:"rollout-automations-manager"},a.mode==="LIST"&&at.createElement(xo,{onEditAutomation:l=>s({mode:"EDIT",automationId:l.id}),onCreateAutomation:()=>s({mode:"CREATE"}),filter:o}),(a.mode==="CREATE"||a.mode==="EDIT")&&at.createElement("div",{className:"rollout-automations-manager__navbar"},at.createElement("button",{type:"button","aria-label":"Return to automations list button",className:"rollout-automations-manager__back-btn",onClick:()=>s({mode:"LIST"})},at.createElement(ya,{className:"rollout-automation-form__header-back__arrow"}))),a.mode==="CREATE"&&at.createElement(go,{onBeforeAutomationCreate:r,onAutomationCreated:l=>{t==null||t(l),s({mode:"LIST"})},prefilled:n,renderFields:i}),a.mode==="EDIT"&&at.createElement(bo,{automationId:a.automationId,onAutomationUpdated:()=>s({mode:"LIST"}),onAutomationDeleted:()=>s({mode:"LIST"}),renderFields:i}))}import h,{useCallback as Co,useEffect as Be,useMemo as Et,useState as Ee}from"react";import{useSpinDelay as xa}from"spin-delay";import{useLazyQuery as Wt,useMutation as $e,useQuery as Re,useTRPCContext as Ca}from"@rollouthq/api-client-react";import{inputDefToZodObject as Le}from"@rollouthq/common/";import{Center as Me,FormControl as _a,Spinner as ha,useAsyncMemo as Aa}from"@rollouthq/ui";import{useMemo as Oe}from"react";import{z as U}from"zod";var xt=U.object({name:U.string().min(1),trigger:U.object({appKey:U.string(),triggerKey:U.string(),credentialId:U.string(),inputParams:U.object({})}),action:U.object({appKey:U.string(),actionKey:U.string(),credentialId:U.string(),inputParams:U.object({})})});function Ne(e){let{data:t={},actionInputParamsSchema:r,triggerInputParamsSchema:n}=e,o=Oe(()=>xt.extend({trigger:xt.shape.trigger.extend({inputParams:n}),action:xt.shape.action.extend({inputParams:r})}),[r,n]);return Oe(()=>o.safeParse(t),[t,o])}function _o(e){var Rt,ht,At,It,vt,Pt,$,E;let{blueprintId:t}=e,{client:r,invalidateQueries:n}=Ca(),[o,i]=Ee(),a=Wt("triggers.getPayloadSchema"),s=Wt("apps.authInfo"),l=Wt("apps.triggers"),p=dt(o==null?void 0:o.trigger);Be(()=>{let c=o==null?void 0:o.trigger;c!=null&&(s.fetch({appKey:c.appKey}),l.fetch({appKey:c.appKey}),c.triggerKey!=null&&c.appKey!=null&&a.fetch({appKey:c.appKey,triggerKey:c.triggerKey}))},[o==null?void 0:o.trigger]);let d=Wt("apps.authInfo");Be(()=>{var c;((c=o==null?void 0:o.action)==null?void 0:c.appKey)!=null&&d.fetch({appKey:o.action.appKey})},[(Rt=o==null?void 0:o.action)==null?void 0:Rt.appKey]);let u=Re(["blueprints.get",{blueprintId:t}],{onSuccess:c=>{o==null&&(c.automation!=null?i({name:c.automation.name,action:c.automation.action,trigger:c.automation.trigger}):i({name:c.name,action:c.action,trigger:c.trigger}))}}),f=$e("blueprints.createAutomation"),m=$e("blueprints.deactivateAutomation"),g=Et(()=>p==null?xt.shape.action.shape.inputParams:"inputParamsSchema"in p?p.inputParamsSchema:Le(p.inputParamDefs),[p]),y=ct({actionRef:o==null?void 0:o.action}),_=Et(()=>y==null?xt.shape.action.shape.inputParams:"inputParamsSchema"in y?y.inputParamsSchema:Le(y.inputParamDefs),[y]),C=Ne({data:o,triggerInputParamsSchema:g,actionInputParamsSchema:_}),k=Co(c=>i(A=>({...A,trigger:{...A==null?void 0:A.trigger,credentialId:c}})),[i]),v=Co(c=>i(A=>({...A,action:{...A==null?void 0:A.action,credentialId:c}})),[i]);Ft({appKey:(ht=o==null?void 0:o.trigger)==null?void 0:ht.appKey,setCredentialId:k});let P=Co(c=>{i(A=>({...A,trigger:{...A.trigger,inputParams:c}}))},[i]),O=(vt=Re(["apps.triggers",{appKey:(At=o==null?void 0:o.trigger)==null?void 0:At.appKey}],{enabled:((It=o==null?void 0:o.trigger)==null?void 0:It.appKey)!=null}).data)==null?void 0:vt.find(c=>{var A;return c.key===((A=o==null?void 0:o.trigger)==null?void 0:A.triggerKey)}),L=Aa(async()=>{var c,A,Lt;return O==null?[]:O.payloadConfiguration.type==="static"?O.payloadConfiguration.staticSchema:await r.query("triggers.getPayloadSchema",{appKey:(c=o==null?void 0:o.trigger)==null?void 0:c.appKey,triggerKey:(A=o==null?void 0:o.trigger)==null?void 0:A.triggerKey,inputParams:(Lt=o==null?void 0:o.trigger)==null?void 0:Lt.inputParams})},[JSON.stringify(O==null?void 0:O.payloadConfiguration),JSON.stringify(o==null?void 0:o.trigger)]),j=Et(()=>(L.value??[]).map(c=>({id:c.key,label:c.label,type:"string"})),[L.value]);function V(){return(o==null?void 0:o.action)==null||y==null?null:h.createElement("div",{className:"rollout-automation-form__action-inputs"},h.createElement("div",null,h.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),h.createElement("div",{className:"rollout-automation-form__credential"},h.createElement(_a,{label:"Account",isRequired:!0},h.createElement(rt,{error:C.success?void 0:C.error.issues.find(c=>c.path.join(".")==="action.credentialId"),credentialId:o.action.credentialId,setCredentialId:c=>{let A={...o.action,credentialId:c};i({...o,action:A})},authInfoQuery:d,appKey:o.action.appKey}))),h.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},h.createElement(it,{isBlueprintActivation:!0,api:r,credentialId:o.action.credentialId,inputParams:o.action.inputParams,setInputParams:c=>i({...o,action:{...o.action,inputParams:c}}),renderInputParams:void 0,importedData:y,variables:j,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}}))))}let b=(($=(Pt=u.data)==null?void 0:Pt.automation)==null?void 0:$.active)??!1,[x,Q]=Ee(!1),Y=Et(()=>({shouldShowErrors:x,setShouldShowErrors:Q}),[x,Q]),Jt=Et(()=>[],[]);async function $t(){if(Q(!0),C.success){let c=C.data;await f.mutateAsync({blueprintId:t,trigger:{credentialId:c.trigger.credentialId,inputParams:c.trigger.inputParams},action:{credentialId:c.action.credentialId,inputParams:c.action.inputParams}}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}else console.log(o),console.error(C.error)}async function Gt(){await m.mutateAsync({blueprintId:t}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}let So=xa(o==null,{delay:500,minDuration:200});if(o==null)return null;if(So)return h.createElement("div",{className:"rollout__loading_spinner_container"},h.createElement(ha,{className:"rollout__loading_spinner"}));let to=p&&("inputParamsSchema"in p?Object.keys(p.inputParamsSchema.shape).length>0:p.inputParamDefs.length>0),oo=((E=o.trigger)==null?void 0:E.triggerKey)!=null&&h.createElement("div",{className:"rollout-blueprint-activator__trigger"},h.createElement("div",{className:"rollout-blueprint-activator__label"},"Set up trigger"),h.createElement("div",{className:"rollout-blueprint-activator__trigger__fields"},h.createElement(rt,{error:C.success?void 0:C.error.issues.find(c=>c.path.join(".")==="trigger.credentialId"),appKey:o.trigger.appKey,setCredentialId:c=>i({...o,trigger:{...o.trigger,credentialId:c}}),authInfoQuery:s,credentialId:o.trigger.credentialId}),o.trigger.credentialId!=null&&to&&h.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},h.createElement(it,{api:r,credentialId:o.trigger.credentialId,inputParams:o.trigger.inputParams,setInputParams:P,renderInputParams:void 0,importedData:p,variables:Jt,getDynamicOptions:({inputKey:c})=>{var A;return r.query("triggers.getTriggerInputOptions",{triggerKey:(A=o.trigger)==null?void 0:A.triggerKey,inputKey:c})}}))));return h.createElement(Vt,{value:Y},h.createElement("div",null,u.data!=null&&h.createElement("div",null,h.createElement("div",{className:"rollout-blueprint-activator__header"},h.createElement("div",{className:"rollout-automations-list-item__icons"},h.createElement(Me,{className:"rollout-automations-list-item__trigger"},h.createElement(D,{appKey:u.data.trigger.appKey})),h.createElement(Me,{className:"rollout-automations-list-item__action"},h.createElement(D,{appKey:u.data.action.appKey}))),h.createElement("div",{className:"rollout-blueprint-activator__name"},u.data.name)),oo,V(),h.createElement("div",null,b?h.createElement("button",{type:"button","aria-label":"Deactivation button",disabled:f.isLoading,className:"rollout-blueprint-activator__deactivate-btn rollout-button--primary",onClick:Gt},f.isLoading?"Deactivating...":"Deactivate"):h.createElement("button",{type:"button","aria-label":"Activation button",disabled:f.isLoading,className:"rollout-blueprint-activator__activate-btn rollout-button--primary",onClick:$t},f.isLoading?"Activating...":"Activate")))))}import{matchSorter as Ve}from"match-sorter";import T,{useState as Ia}from"react";import{useMutation as va,useTRPCContext as Pa}from"@rollouthq/api-client-react";import{isChildofInteractiveElement as Fa,Center as je,Search as Sa,TextField as Da,Spinner as Ta,Switch as Ka}from"@rollouthq/ui";function ho(e){let{blueprints:t,isLoading:r=!1,onOpenActivationForm:n}=e,[o,i]=Ia(""),a=Ve(t,o,{keys:["name","action.app.name"],threshold:Ve.rankings.ACRONYM}),s=a.length===0;return T.createElement("div",{className:"rollout-automations-list__container"},T.createElement("div",{className:"rollout-automations-list__search-input__group"},T.createElement("div",{className:"rollout-automations-list__search-input__left-element"},T.createElement(Sa,null)),T.createElement(Da,{placeholder:"Search blueprints",value:o,onChange:i,className:"rollout-automations-list__search-input"})),r&&T.createElement("div",{className:"rollout__loading_spinner_container"},T.createElement(Ta,{className:"rollout__loading_spinner"})),!r&&s&&T.createElement("div",{className:"rollout-automations-list__empty-msg"},"No blueprints found"),T.createElement("div",{className:"rollout-automations-list__list"},a.map(l=>T.createElement(wa,{key:l.id,blueprint:l,onOpenActivationForm:()=>n(l)}))))}function wa(e){var a;let{blueprint:t,onOpenActivationForm:r}=e,{invalidateQueries:n}=Pa(),o=va("blueprints.deactivateAutomation"),i=((a=t.automation)==null?void 0:a.active)??!1;return T.createElement("div",{className:"rollout-automations-list__item-wrapper"},T.createElement("div",{className:"rollout-automations-list__item",role:"group",onClick:s=>{Fa(s.target)||r()}},T.createElement("div",{className:"rollout-automations-list-item__header"},T.createElement("div",{className:"rollout-automations-list-item__icons"},T.createElement(je,{className:"rollout-automations-list-item__trigger"},T.createElement(D,{appKey:t.trigger.appKey})),T.createElement(je,{className:"rollout-automations-list-item__action"},T.createElement(D,{appKey:t.action.appKey}))),T.createElement("div",{className:"rollout-automations-list-item__switch"},T.createElement(Ka,{isSelected:i,onChange:async()=>{if(i){let s=t.id;await o.mutateAsync({blueprintId:s}),n(["blueprints.get",{blueprintId:s}]),n(["blueprints.getAutomation",{blueprintId:s}]),n(["blueprints.list"])}else r()}}))),T.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}import tt,{useState as Oa}from"react";import Zt from"react";import{useQuery as ka}from"@rollouthq/api-client-react";function Ao(e){let{onOpenActivationForm:t}=e,r=ka(["blueprints.list"]);return Zt.createElement("div",null,Zt.createElement("div",{className:"rollout-automations-list__header"},Zt.createElement("span",{className:"rollout-automations-list__header-title"},"My blueprints")),Zt.createElement(ho,{blueprints:r.data??[],isLoading:r.isFetching,onOpenActivationForm:t}))}import{ArrowBack as Na}from"@rollouthq/ui";function Ba(){let[e,t]=Oa({mode:"LIST"});return tt.createElement("div",{className:"rollout-automations-manager"},e.mode==="LIST"&&tt.createElement(Ao,{onOpenActivationForm:r=>{t({mode:"ACTIVATE",blueprintId:r.id})}}),e.mode==="ACTIVATE"&&tt.createElement(tt.Fragment,null,tt.createElement("div",{className:"rollout-automations-manager__navbar"},tt.createElement("button",{type:"button","aria-label":"Return to blueprints list button",className:"rollout-blueprints-manager__back-btn",onClick:()=>t({mode:"LIST"})},tt.createElement(Na,{className:"rollout-automation-form__header-back__arrow"}))),tt.createElement(_o,{blueprintId:e.blueprintId})))}import lt from"react";import{RolloutIcon as Ea,st as Ct}from"@rollouthq/ui";function $a(){return lt.createElement(Ct.div,{css:{textAlign:"center"}},lt.createElement(Ct.div,{css:{display:"flex",justifyContent:"center",alignItems:"center"}},lt.createElement(Ea,{width:"16px"}),lt.createElement(Ct.span,{css:{paddingLeft:"$2",fontWeight:700,color:"$neutral-2"}},"Powered by Rollout")),lt.createElement(Ct.div,{css:{marginTop:"$2",fontSize:"8px",color:"$grayMedium"}},"By automating, you agree to Rollout's"," ",lt.createElement(Ct.a,{href:"https://docs.rollouthq.com/security-and-legal/security",css:{color:"black",textDecoration:"underline"}},"Terms")," ","&"," ",lt.createElement(Ct.a,{href:"https://docs.rollouthq.com/security-and-legal/privacy-policy",css:{color:"black",textDecoration:"underline"}},"Privacy policy")))}import Qe,{useContext as Io,useMemo as ze,useState as Ra,useLayoutEffect as La}from"react";function vo(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var Po={};vo(Po,"SSRProvider",()=>Fo);vo(Po,"useSSRSafeId",()=>Va);vo(Po,"useIsSSR",()=>ja);var Ht={prefix:String(Math.round(Math.random()*1e10)),current:0},Yt=Qe.createContext(Ht);function Fo(e){let t=Io(Yt),r=ze(()=>({prefix:t===Ht?"":`${t.prefix}-${++t.current}`,current:0}),[t]);return Qe.createElement(Yt.Provider,{value:r},e.children)}var Ma=Boolean(typeof window<"u"&&window.document&&window.document.createElement);function Va(e){let t=Io(Yt);return t===Ht&&!Ma&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server."),ze(()=>e||`react-aria${t.prefix}-${++t.current}`,[e])}function ja(){let t=Io(Yt)!==Ht,[r,n]=Ra(t);return typeof window<"u"&&t&&La(()=>{n(!1)},[]),r}import{BrowserClient as Ua,defaultIntegrations as qa,defaultStackParser as Wa,makeFetchTransport as Za}from"@sentry/browser";import _t,{useCallback as Ya,useState as Ha}from"react";import{ErrorBoundary as Xa}from"react-error-boundary";import{RolloutAPIClientProvider as Ja}from"@rollouthq/api-client-react";import st from"react";import{Gear as Qa}from"@rollouthq/ui";import{RedQuestion as za}from"@rollouthq/ui";function Ue(){return st.createElement("div",{className:"rollout-error-fallback__container"},st.createElement("div",null,st.createElement(Qa,{style:{width:"40px",height:"40px"}}),st.createElement(za,{style:{position:"relative",right:"10px",bottom:"30px"}})),st.createElement("div",{className:"rollout-error-fallback__text-container"},st.createElement("div",{className:"rollout-error-fallback__message"},"An unexpected error occured"),st.createElement("div",{className:"rollout-error-fallback__additional-info"},"Please try again later")))}var qe="https://app.rollouthq.com/api",Ga="https://28e3dd4b02f14f2eb74768520edbc8a1@o345148.ingest.sentry.io/6463365";function tl(e){let{token:t,allowedApps:r,apiBaseUrl:n=qe,children:o,env:i="production",onError:a}=e,[s]=Ha(()=>new Ua({dsn:Ga,transport:Za,stackParser:Wa,integrations:qa})),l=Ya((p,d)=>{a==null||a(p,d),i==="production"&&s.captureException(p,{data:{info:d}})},[i,s,a]);return _t.createElement(Xa,{FallbackComponent:Ue,onError:l},_t.createElement(zo,{apiBaseUrl:n},_t.createElement(Zo,{allowedApps:r},_t.createElement(Ja,{token:t,apiBaseUrl:n??qe},_t.createElement(te,null,_t.createElement(Fo,null,o))))))}import{curlyTemplate as wf}from"@rollouthq/common";import{globalCss as ol}from"@rollouthq/ui";var Xt={border:"1px solid #D5DCE2",borderRadius:"8px",padding:"16px",marginTop:"24px",background:"white"},Sf=ol({".rollout-automation-form__line-items-container":{border:"1px solid #DFE1E4",borderRadius:"8px"},".rollout-automation-form__line-items-header":{padding:"12px",display:"flex",gap:"12px",alignItems:"flex-start",flexDirection:"column",background:"linear-gradient(180deg, rgba(255, 255, 255, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), #FFFFFF"},".rollout-automation-form__line_items-description":{fontSize:"13px"},".rollout-automation-form__line-items-title":{fontSize:"13px",fontWeight:"600"},".rollout-automation-form__line-items-content":{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},".rollout-automations-list__container":{display:"flex",flexDirection:"column"},".rollout-automations-list__header":{display:"flex",paddingY:"16px",marginBottom:"16px",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #EFF1F4"},".rollout-automations-list__header-title":{fontWeight:"600"},".rollout-error-fallback__container":{boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"32px",gap:"16px",margin:"24px auto",width:"572px",height:"173px",border:"1px solid #D5DCE2",borderRadius:"8px"},".rollout-error-fallback__text-container":{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",width:"227px",height:"48px"},".rollout-error-fallback__message":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontWeight:"600",fontSize:"16px",lineHeight:"150%"},".rollout-error-fallback__additional-info":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontweight:"500",fontSize:"13px",lineHeight:"150%"},".rollout-combobox__input__spinner":{width:"1rem",height:"1rem"},".rollout-combobox__input":{width:"100%",paddingX:"$2",paddingY:"$2-5",background:"none",outline:"none",border:"none",cursor:"text",paddingRight:"40px",fontSize:"13px","&:focus":{borderColor:"$interactPrimary"},"[data-disabled]":{opacity:.4,cursor:"not-allowed"},".rollout-combobox__input__left-element[data-icon] ~ &":{paddingLeft:"40px"},"&:disabled":{cursor:"not-allowed"}},".rollout-select__tag":{margin:"2px",paddingX:"6px",paddingY:"1px",height:"fit-content",display:"flex",alignItems:"center",gap:"4px",background:"white",border:"1px solid #EFF1F4",borderRadius:"4px",fontWeight:"500",cursor:"pointer",whiteSpace:"nowrap"},".rollout-select__tag-icon":{color:"#91959C","&:hover":{color:"black"}},".rollout-select__input":{background:"none",outline:"none",border:"none",width:"100%","&:disabled":{cursor:"not-allowed"}},".rollout-select__input__group":{background:"#F8F9FB",height:"36px",paddingX:"8px",".rollout-select__input":{paddingLeft:"0"}},".rollout-form-control__input[data-error]":{".rollout-combobox__input__group, .rollout-select__input__group, .rollout__base-input":{borderColor:"$error"}},".rollout-combobox__input__group, .rollout-select__input__group":{position:"relative",overflow:"hidden",display:"flex",alignItems:"center",fontSize:"13px",outline:"none",overflowX:"hidden",borderWidth:"1px",borderRadius:"$md",borderStyle:"solid",borderColor:"$strokeMedium","&[data-focused]":{borderColor:"$interactPrimary"},"&[data-disabled]":{cursor:"not-allowed",color:"$grayMedium",backgroundColor:"$surfaceSecondary"}},".rollout-connect-combobox__label, .rollout-connect-select__label":{marginBottom:"$2",span:{color:"$primary"}},".rollout-combobox__input__left-element, .rollout-combobox__input__right-element":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute","&:not([data-open])":{pointerEvents:"none"},"&[data-open]":{cursor:"pointer"},top:"50%",transform:"translateY(-50%)",zIndex:2,color:"#91959C",border:"none",background:"none"},".rollout-combobox__input__left-element":{size:"24px",left:"8px","&:not([data-icon])":{display:"none"},"[data-avatar][data-selected] &":{background:"transparent",border:"none",color:"white",fontSize:"$1"},borderWidth:"1px",borderColor:"#EFF1F4",borderStyle:"solid",borderRadius:"6px",background:"white"},".rollout-combobox__input__right-element, .rollout-select__input__right-element":{size:"16px",right:"8px"},".rollout-combobox__input__spinner, .rollout-select__input__spinner":{flexShrink:"0",size:"12px"},".rollout-combobox__content, .rollout-select__content":{maxHeight:"288px",overflowX:"hidden",overflowY:"auto",outline:"none",border:"solid 1px",borderColor:"#D5DCE2",borderRadius:"8px",".rollout-tab__list":{background:"#282A2F",padding:"10px 12px",fontSize:"13px",color:"white",fontWeight:"600",gap:"16px",border:"none"},".rollout-tabs__tab":{overflowX:"hidden !important",padding:"0",border:"none",color:"white",opacity:"0.4","&[data-selected]":{opacity:"1"}}},".rollout-select__multiple-alert":{display:"flex",alignItems:"center",gap:"8px",paddingX:"12px",paddingY:"8px",background:"#5386F6",color:"white",span:{fontSize:"13px",fontWeight:"500"}},".rollout-combobox__content ul":{margin:"0px",padding:"0px"},".rollout-select__content ul":{margin:"0px",padding:"0px"},".rollout-select__option-check__icon":{marginLeft:"auto"},".rollout-listbox":{width:"100%",margin:0,padding:0},".rollout-listbox__option, .rollout-select__option":{display:"flex",alignItems:"center",padding:"$2",fontSize:"$2",outline:"none",cursor:"pointer",borderBottom:"solid 1px",borderColor:"#F8F9FB","&[data-focused]":{background:"#F4F5F8"},"&[data-disabled]":{fontWeight:"500",color:"#91959C"},"&[data-selected]":{fontWeight:"500",color:"#5284F2",diaplay:"flex",alignItems:"center"}},".rollout-listbox__option-icon":{"[data-avatar] &":{background:"#C3C7CE;",color:"white",border:"none",borderRadius:"100%",padding:0,fontSize:"$1"},borderWidth:"1px",borderColor:"$strokeMedium",borderStyle:"solid",borderRadius:"$md",background:"white",size:"$6",padding:"$1",marginRight:"$1-5"},".rollout-automations-list__search-input":{paddingX:"40px",paddingY:"10px",borderRadius:"$md",outline:"none",borderWidth:"2px",borderColor:"#EFF1F4","&:focus":{borderColor:"$interactPrimary"},borderStyle:"solid",background:"#F8F9FB"},".rollout-automations-list__search-input__group":{position:"relative",display:"flex",marginBottom:"$4",color:"#91959C"},".rollout-automations-list__search-input__left-element":{position:"absolute",left:"0px",top:"0px",zIndex:2,display:"flex",size:"40px",fontSize:"$md",alignItems:"center",justifyContent:"center",pointerEvents:"none",svg:{size:"20px"}},".rollout-automations-list__not-found":{paddingInlineStart:"$4"},".rollout-form-control-find__container":{display:"flex",background:"#e0e1e4",width:"max-content",borderRadius:"6px"},".rollout-form-control-find__active":{color:"#5d88ef",fontSize:"0.8125rem",fontFamily:"inherit",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"white",height:"32px",cursor:"pointer",borderRadius:"8px",border:"1px solid #e0e1e4"},".rollout-form-control-find__disabled":{color:"#6c6f75",fontFamily:"inherit",fontSize:"0.8125rem",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"e0e0e5",height:"32px",cursor:"pointer",borderRadius:"8px"},".rollout-automations-list__new-btn":{display:"flex",alignItems:"center",gap:"8px",padding:"4px 12px",whiteSpace:"nowrap",backgroundColor:"#5386F7",color:"white",border:"none",borderRadius:"8px",height:"32px",cursor:"pointer"},".rollout-automations-list__empty-msg":{textAlign:"center",padding:"20px",border:"1px solid #eff1f4",borderRadius:"4px"},".rollout-automations-list__error-msg":{textAlign:"center",padding:"20px",border:"1px dashed #AA4849",borderRadius:"4px"},".rollout-automations-list__list":{display:"grid",gap:"16px",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))"},".rollout-automations-list__item-wrapper":{position:"relative",marginBottom:"8px",maxWidth:"343px",border:"1px solid #D5DCE2",borderRadius:"8px","&:hover":{border:"1px solid #ADB4BA"},"&[data-deleting]":{opacity:.4},"&[data-deleting]::after":{content:"''",position:"absolute",inset:0,userSelect:"none",cursor:"wait"}},".rollout-automations-list__item":{padding:"16px",cursor:"pointer"},".rollout-automations-list-item__header":{display:"flex",alignItems:"center",justifyContent:"space-between"},".rollout-automations-list-item__draft-badge":{marginLeft:"auto",marginRight:"10px",padding:"4px 8px",borderRadius:"40px",background:"$neutral-4",fontSize:"small",color:"white"},".rollout-automations-list-item__icons":{display:"inline-flex",".rollout-automations-list-item__trigger, .rollout-automations-list-item__action":{padding:"$1",borderStyle:"solid",borderWidth:"1px",borderColor:"$strokeMedium",borderRadius:"$md",fontSize:"24px"},":first-child":{borderStartEndRadius:"unset",borderEndEndRadius:"unset",marginRight:"-1px"},":last-child":{borderStartStartRadius:"unset",borderEndStartRadius:"unset"},size:"fit-content"},".rollout-automations-list-item__name":{marginTop:"12px",fontSize:"16px",fontWeight:"600",color:"#31373F",height:"72px"},".rollout-automations-list-item__options__trigger":{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",cursor:"pointer",color:"#91959C",transition:"all .2s ease",size:"32px",svg:{size:"16px"},"&:hover":{bg:"rgba(219, 97, 92, 0.1)",color:"#DB615C"},opacity:0,'[role="group"]:hover:not([data-open]) &':{opacity:1}},".rollout-automations-list-item__options__content":{position:"absolute",padding:"18px 16px",inset:"0",background:"white",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"12px",justifyContent:"center",alignItems:"center",span:{fontWeight:"600"}},".rollout-automations-list-item__options__delete-item-btn":{background:"#DB615C",color:"white",whiteSpace:"nowrap","&:hover":{background:"#C74D48"},cursor:"pointer"},".rollout-automations-list-item__options__cancel-item-btn":{border:"1px solid #282A2F",cursor:"pointer"},".rollout-automations-manager__navbar":{paddingY:"$3"},".rollout-automations-manager__back-btn":{border:"none",background:"none"},".rollout-automation-form__header-back__arrow":{cursor:"pointer"},".rollout-automations-list-item__options__content button":{fonSize:"13px",fontWeight:"500",borderRadius:"8px",height:"32px",width:"100%",cursor:"pointer",transition:"all .2s ease"},".rollout-automation-form__name":{height:"36px",fontWeight:500,fontSize:"13px",background:"none",border:"1px solid",borderColor:"$strokeDark",borderRadius:"8px",paddingX:"$4",paddingY:"$2-5",outline:"none","&[aria-invalid]::placeholder":{color:"$error"}},".rollout-automation-form__action-inputs-wrapper, .rollout-automation-form__trigger-inputs-wrapper":{display:"flex",flexDirection:"column",gap:"$3"},".rollout-automation-form__trigger":{...Xt},".rollout-automation-form__trigger-inputs":{...Xt},".rollout-automation-form__action":{...Xt},".rollout-automation-form__action-inputs":{...Xt},".rollout-automation-form__trigger-trigger":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__trigger-app ":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__credentials":{marginTop:"$3"},".rollout-automation-form__action .rollout-automation-form__action-app":{marginBottom:"$3"},".rollout-automation-form__action .rollout-automation-form__action-action":{marginBottom:"$3"},".rollout-automation-form__credential":{marginBottom:"$3"},".rollout-automation-form__label":{fontWeight:"600",marginBottom:"12px"},".rollout-automation-form__helper-text":{marginBottom:"12px"},".rollout-automation-form__content":{marginBottom:"16px"},".rollout-automation-form-oauth__error__message":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-input":{height:"36px",paddingX:"$2",paddingY:"$2-5",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"6px"},".rollout-button--primary, .rollout-button--secondary, .rollout-button--danger":{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",height:"32px",padding:"4px 12px",fontWeight:600,whiteSpace:"nowrap",textAlign:"center",border:"1px solid",borderRadius:"8px"},".rollout-button--primary":{backgroundColor:"#5386F7",borderColor:"#5386F7",color:"white"},".rollout-button--secondary":{backgroundColor:"$grayMedium",borderColor:"$grayMedium",color:"white"},".rollout-button--danger":{color:"white",backgroundColor:"$error",borderColor:"$error","&:hover":{backgroundColor:"#A92F2A",borderColor:"#A92F2A"}},".rollout-automation-form__buttons":{display:"flex",gap:"$3"},".rollout-automation-form__cancel":{marginLeft:"auto"},".rollout-automation-form__delete":{position:"relative",marginLeft:"auto",".rollout-automation-form__cancel ~ &":{marginLeft:"0"}},".rollout-automation-form-delete__confirm-dialog":{position:"absolute",bottom:"100%",right:"0",whiteSpace:"nowrap",background:"white",marginBottom:"12px",padding:"12px",border:"1px solid #F8F9FB",borderRadius:"8px",boxShadow:"0px 4px 16px rgba(0, 0, 0, 0.2)"},".rollout-automation-form__delete-confirm-text":{padding:"$3",fontSize:"$2",fontWeight:500},".rollout-automation-form__delete-confirm-buttons":{display:"flex",justifyContent:"space-between",gap:"$3",marginTop:"$4"},".rollout-automation-form__delete-cancel, .rollout-automation-form__delete-confirm":{width:"100%"},".rollout-automation-form__submit[disabled], .rollout-automation-form__submit[data-loading]":{opacity:.3},".rollout-form-control__label":{marginBottom:"8px",fontSize:"$2",fontWeight:500,display:"flex",alignItems:"center"},".rollout-form-control__lock-btn":{marginLeft:"auto",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #EFF1F4",size:"20px",cursor:"pointer",borderRadius:"4px",boxShadow:"$md",color:"#91959C",transition:"all .2s ease","&[data-locked]":{color:"#9A58F6"},"&:hover":{background:"#F8F9FB"},svg:{height:"14px"}},".rollout-form-control__required-hint":{paddingLeft:"4px",color:"$primary"},".rollout-form-control__description":{marginBottom:"8px",fontSize:"13px"},".rollout-form-control__error":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-automation-form__api-token-input":{height:"32px",marginTop:"$2",marginBottom:"$4",background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},".rollout-automation-form__api-token-input-info":{fontSize:"0.75rem",marginBottom:"$1-5",color:"#6C6F75"},".rollout-automation-form__api-token-input-label":{fontSize:"$2",marginTop:"$1-5"},".rollout-automation-form__api-token-input-container":{marginTop:"$2"},".rollout-automation-form__api-token-connection-result":{fontSize:".85rem"},".rollout-automation-form__api-token-apitoken-button-container":{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"$2-5"},".rollout-blueprint-activator__header":{display:"flex",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"$strokeMedium",paddingY:"12px"},".rollout-blueprint-activator__name":{marginLeft:"16px"},".rollout-blueprint-activator__label":{padding:"12px",fontSize:"$3",fontWeight:"bold",borderBottom:"1px solid",borderBottomColor:"$strokeMedium"},".rollout-blueprint-activator__trigger":{marginTop:"12px",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"8px","& .rollout-automation-form__credentials":{marginBottom:"$3"}},".rollout-blueprint-activator__trigger__fields":{padding:"12px"},".rollout-blueprint-activator__activate-btn, .rollout-blueprint-activator__deactivate-btn":{marginTop:"12px"},".rollout__loading_spinner_container":{padding:"1rem",display:"flex",justifyContent:"center"},".rollout__loading_spinner":{height:"1rem",width:"1rem"},".rollout__base-input":{background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},"input.rollout__base-input, select.rollout__base-input":{height:"32px"},".rollout__terms-of-service-link, .rollout__privacy-policy-link":{color:"#31373F",textDecoration:"underline","&:hover":{color:"#1e2227"}},".ace_editor":{backgroundColor:"$surfaceSecondary"},".rollout-card":{display:"flex",flexDirection:"column",gap:"12px",marginTop:"12px",padding:"16px",border:"1px solid #d5dce2",borderRadius:"8px"}});export{go as AutomationCreator,bo as AutomationEditor,ba as AutomationsManager,_o as BlueprintActivator,ho as BlueprintsList,Ba as BlueprintsManager,xo as MyAutomations,Ao as MyBlueprints,$a as PoweredByRollout,tl as RolloutConnectProvider,We as components,wf as curlyTemplate,Sf as defaultTheme};
//# sourceMappingURL=index.esm.js.map