var or=Object.defineProperty;var Bo=(o,t)=>{for(var r in t)or(o,r,{get:t[r],enumerable:!0})};var Je={};Bo(Je,{AutomationCreator:()=>Co,AutomationEditor:()=>ho,AutomationsManager:()=>Fa,BlueprintActivator:()=>vo,BlueprintsList:()=>Po,BlueprintsManager:()=>za,MyAutomations:()=>Ao,MyBlueprints:()=>Fo,PoweredByRollout:()=>Ya,RolloutConnectProvider:()=>dl,TaskInitiator:()=>Wa});import ke,{useState as ia}from"react";import{useMutation as aa}from"@rollouthq/api-client-react";import D,{useCallback as xo,useMemo as Nt}from"react";import{useState as Xi}from"react";import{useSpinDelay as Ji}from"spin-delay";import{useQuery as Gi,useTRPCContext as ta}from"@rollouthq/api-client-react";import{inputDefToZodObject as Te}from"@rollouthq/common";import on,{useLayoutEffect as en}from"react";import{useEffect as rn,useState as nn}from"react";import{isVariable as an,z as Yo}from"@rollouthq/common";var et={};Bo(et,{BooleanInput:()=>qr,DropdownInput:()=>Fr,FileBrowserInput:()=>Hr,FindBy:()=>Dr,MultiSelectInput:()=>jr,NoInputsComponent:()=>Wr,RichTextInput:()=>Er});import W,{useEffect as Lo,useState as Mo}from"react";import{isVariable as hr,ROLLOUTHQ_VARIABLE_PREFIX as Ar}from"@rollouthq/common";import ao from"react";import{createContext as er}from"@rollouthq/ui";var[No,w]=er({name:"AppComponentRenderer"});import{useCallback as lr}from"react";import{get as sr,getPath as $o,set as ur}from"ts-object-path";import{inputDefToZodObject as pr}from"@rollouthq/common";import{getPath as rr}from"ts-object-path";import{ZodObject as nr,ZodOptional as ir,ZodRecord as ar}from"zod";function Eo(o,t){let r=rr(t);return io(o,r)}function io(o,t){let r=t.slice(1),n=o instanceof ir?o.unwrap():o;if(n instanceof nr){let e=n.shape[t[0]];return t.length>1?io(e,r):e}if(n instanceof ar){let e=n.valueSchema;return t.length>1?io(e,r):e}throw console.error("getByPath: unhandled prop type:",n),new Error("getByPath: unhandled prop type")}function N(o){let t=w(),{inputParams:r,setInputParams:n,importedData:e,credentialId:l,isBlueprintActivation:a}=t,i=$o(o),s=sr(r,o),u=lr(F=>{let A=structuredClone(r);ur(A,o,F),n(A)},[n,r]),m="inputParamsSchema"in e?e.inputParamsSchema:pr(e.inputParamDefs),c=Eo(m,o),d=c.isOptional(),p=c.description,f=(p==null?void 0:p.label)??dr(i),x=(p==null?void 0:p.description)??"",_=(p==null?void 0:p.isCredentialDependent)??!1,C=m.safeParse(r),v=_&&l==null&&!a?void 0:mr(C,o);return{value:s,setValue:u,isOptional:d,label:f,description:x,isCredentialDependent:_,error:v,path:i}}function mr(o,t){let r=$o(t);if(!o.success)return o.error.issues.find(n=>n.path.join(".")===r.join("."))}function dr(o){return o.map(t=>cr(t.toString())).join(" ")}function cr(o){let t=o.replace(/([A-Z\d])/g,r=>` ${r.toLowerCase()}`);return`${t[0].toUpperCase()}${t.slice(1)}`}import pt from"react";import{dataAttr as fr}from"@rollouthq/ui";function zt(o){let{label:t,description:r,error:n,isRequired:e,children:l}=o;return pt.createElement("div",{className:"rollout-form-control"},t&&pt.createElement("div",{className:"rollout-form-control__label"},t,e&&pt.createElement("span",{className:"rollout-form-control__required-hint"}," ","(required)")),r&&pt.createElement("div",{className:"rollout-form-control__description"},r),pt.createElement("div",{className:"rollout-form-control__input","data-error":fr(!!n)},l),n&&pt.createElement("div",{className:"rollout-form-control__error"},n))}import{Flex as gr,UserForm as br}from"@rollouthq/ui";function Q(o){let{bind:t,children:r,description:n,error:e,isRequired:l=!1}=o,{credentialId:a,isBlueprintActivation:i=!1}=w(),s=N(t),u=s.isCredentialDependent&&a==null&&!i;if(i&&!s.isCredentialDependent)return null;function m(){return u?ao.createElement(gr,{css:{alignItems:"center",padding:"8px",backgroundColor:"$surfaceSecondary",borderRadius:"4px",color:"$grayMedium",fontSize:"13px",fontWeight:500}},ao.createElement(br,{css:{marginRight:"6px"}}),"Input provided by user when automation is activated"):r}let c=o.label??"";return ao.createElement(zt,{description:n,error:e,isRequired:l,label:c},m())}import xr,{createElement as Cr}from"react";import yr from"react";function Ro(o){return yr.createElement("div",{className:"rollout-card"},o.children)}function T(o){let{defaultField:t,ctx:r,renderer:n}=o;return n==null||n===!0?xr.createElement(t,null):n===!1?null:n({...r,createElement:Cr,Card:Ro})}import{createContext as _r}from"@rollouthq/ui";var[Ut,S]=_r({name:"Form"});import{ComboBox as Vo,ComboBoxItem as lo,ComboBoxSection as so,createContext as Ir}from"@rollouthq/ui";var[vr,Pr]=Ir({name:"DropdownInput"});function Fr(o){let r=N(o.bind).path.join("."),{renderInputParams:n}=w(),e=T({defaultField:jo,renderer:n==null?void 0:n[r],ctx:{InputParamField:jo}});return W.createElement(vr,{value:o},e)}function jo(o){var y;let t=Pr(),{bind:r,dependencies:n,fetchOptions:e,allowOnlyVariables:l}=t,a=N(r),{value:i,setValue:s}=a,u=t.label??a.label,m=t.description??a.description,c=t.placeholder||"Select option",[d,p]=Mo([]),[f,x]=Mo(!1),{shouldShowErrors:_}=S(),{variables:C,disabled:v}=w(),F=t.isDisabled||v||n!=null&&n.every(Boolean)!==!0||o.disabled;Lo(()=>{async function b(){x(!0);let j=await e();p(j),x(!1)}!l&&!F&&b()},[JSON.stringify(n),l,F]),Lo(()=>{l&&i&&!hr(i)&&s(void 0)},[l,i]);let A=C.map(b=>({id:`${Ar}${b.id}`,name:`@${b.label}`})),$=[...A,...d],O=$.find(b=>b.id===i),B=W.createElement(Vo,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:F,defaultItems:A,menuTrigger:"focus",selectedOption:O,isLoading:f,inputPlaceholder:c,onSelectionChange:b=>s(b==null?void 0:b.id)},W.createElement(so,{title:"Variables"},A.map(b=>W.createElement(lo,{key:b.id},b.name)))),V=W.createElement(Vo,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:F,defaultItems:$,menuTrigger:"focus",selectedOption:O,key:i,isLoading:f,inputPlaceholder:c,onSelectionChange:b=>s(b==null?void 0:b.id)},W.createElement(so,{title:"Options"},d.map(b=>W.createElement(lo,{key:b.id},b.name))),W.createElement(so,{title:"Variables"},A.map(b=>W.createElement(lo,{key:b.id},b.name)))),q=l?B:V;return W.createElement(Q,{bind:r,label:u,description:m,error:_?(y=a.error)==null?void 0:y.message:void 0,isRequired:!a.isOptional},q)}import mt,{useEffect as Sr}from"react";function Dr(o){var d;let{filterInput:t,filterValueInput:r,selectInput:n}=o,{bind:e}=o,l=N(e),{shouldShowErrors:a}=S(),{value:i,setValue:s,isOptional:u}=l,m=o.label??l.label,c=o.description??l.description;return Sr(()=>{i==null&&s("filter")},[i]),mt.createElement(mt.Fragment,null,mt.createElement(Q,{bind:e,label:m,isRequired:!u,description:c,error:a?(d=l.error)==null?void 0:d.message:void 0},mt.createElement("div",{className:"rollout-form-control-find__container"},mt.createElement("button",{type:"button","aria-label":"Search from list button",className:i=="select"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>s("select")},"From list"),mt.createElement("button",{type:"button","aria-label":"Search by filter button",className:i=="filter"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>s("filter")},"From search"))),i=="filter"&&t,i=="filter"&&r,i=="select"&&n)}import qt,{useCallback as Tr,useMemo as kr}from"react";import{resolveMentions as Kr}from"@rollouthq/common";import{RichEditor as wr,createContext as Or}from"@rollouthq/ui";var[Br,Nr]=Or({name:"RichTextInput"});function Er(o){let r=N(o.bind).path.join("."),{renderInputParams:n}=w(),e=T({defaultField:Qo,renderer:n==null?void 0:n[r],ctx:{InputParamField:Qo}});return qt.createElement(Br,{value:o},e)}function Qo(o){var x;let t=Nr(),{bind:r,inputProps:n,placeholder:e}=t,l=N(r),a=t.label??l.label,i=t.description??l.description,s=w(),{variables:u}=s,{shouldShowErrors:m}=S(),c=s.disabled||t.disabled||o.disabled,d=!l.isOptional||t.isRequired,p=Tr(_=>{l.setValue(_??void 0)},[l.setValue]),f=kr(()=>l.value&&Kr(l.value,u),[l.value,u]);return qt.createElement(Q,{bind:r,label:a,isRequired:d,description:i,error:m?(x=l.error)==null?void 0:x.message:void 0},qt.createElement("div",{className:"rollout-rich-text-input"},qt.createElement(wr,{value:f??null,setValue:p,placeholder:e,formattingEnabled:!1,linksEnabled:!1,mentionVariables:u,isDisabled:c,...n})))}import uo,{useEffect as $r,useState as zo}from"react";import{createContext as Rr,MultiSelect as Lr}from"@rollouthq/ui";var[Mr,Vr]=Rr({name:"MultiSelectInput"});function jr(o){let r=N(o.bind).path.join("."),{renderInputParams:n}=w(),e=T({defaultField:Uo,renderer:n==null?void 0:n[r],ctx:{InputParamField:Uo}});return uo.createElement(Mr,{value:o},e)}function Uo(o){var v;let t=Vr(),{bind:r,dependencies:n,fetchOptions:e,placeholder:l}=t,a=N(r),i=w(),{value:s,setValue:u}=a,m=t.label??a.label,c=t.description??a.description,d=i.disabled||o.disabled||!(n!=null&&n.every(Boolean)),[p,f]=zo([]),[x,_]=zo(!1),{shouldShowErrors:C}=S();return $r(()=>{async function F(){if(_(!0),!d){let A=await e();f(A)}_(!1)}F()},[d]),uo.createElement(Q,{bind:r,label:m,description:c,error:C?(v=a.error)==null?void 0:v.message:void 0},uo.createElement(Lr,{label:m,isDisabled:d,items:p,isLoading:x,inputPlaceholder:l||"Select option",onSelectionChange:F=>{u(F.map(A=>A.id).join(", "))},value:s}))}import po from"react";import{createContext as Qr}from"@rollouthq/ui";var[zr,Ur]=Qr({name:"BooleanInput"});function qr(o){let r=N(o.bind).path.join("."),{renderInputParams:n}=w(),e=T({defaultField:qo,renderer:n==null?void 0:n[r],ctx:{InputParamField:qo}});return po.createElement(zr,{value:o},e)}function qo(o){var d;let t=Ur(),{bind:r}=t,n=N(r),{shouldShowErrors:e}=S(),a=w().disabled||o.disabled,{value:i,setValue:s,isOptional:u}=n,m=t.label??n.label,c=t.description??n.description;return po.createElement(Q,{bind:r,label:m,isRequired:!u,description:c,error:e?(d=n.error)==null?void 0:d.message:void 0},po.createElement("input",{type:"checkbox",checked:i,disabled:a,onChange:p=>s(p.target.checked)}))}import Wo from"react";var Wr=()=>Wo.createElement(Wo.Fragment,null,"No inputs");import mo from"react";import{Spinner as Zr,FileBrowser as Yr}from"@rollouthq/ui";function Hr(o){var _;let{fetchOptions:t,dependencies:r,isDisabled:n,bind:e,selectionMode:l}=o,a=N(e),{value:i,setValue:s}=a,u=o.label??a.label,m=o.description??a.description,{shouldShowErrors:c}=S(),{variables:d,disabled:p}=w(),f=n||p||r!=null&&r.every(Boolean)!==!0,x=mo.createElement(Zr,{className:"rollout-combobox__input__spinner"});return mo.createElement(Q,{bind:e,label:u,isRequired:!a.isOptional||o.isRequired,description:m,error:c?(_=a.error)==null?void 0:_.message:void 0},mo.createElement(Yr,{selectionMode:l,fetchOptions:t,dependencies:r,disabled:f,value:i,setValue:s}))}import{useMemo as Xr}from"react";import Jr from"react";import{createContext as Gr}from"@rollouthq/ui";var[tn,dt]=Gr({name:"RolloutApiBaseUrlContext"});function Zo(o){let{children:t,...r}=o,n=Xr(()=>r,Object.values(r));return Jr.createElement(tn,{value:n},t)}var Ho=typeof document>"u"?rn:en;function ct(o){let{apiBaseUrl:t}=dt(),[r,n]=nn();return Ho(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:Yo},react:on,["@rollouthq/common"]:{z:Yo,isVariable:an},["@rollouthq/connect-react/components/action-inputs"]:et}})},[]),Ho(()=>{if(o==null)return n(void 0);if(!o.appKey||!o.triggerKey)return;let e=o.isTask?"task-triggers":"triggers",l=`${t}/connect-react/${o.appKey}/${e}/${o.triggerKey}.js`;new Function("path","return import(path)")(l).then(i=>{n(i)})},[JSON.stringify(o)]),r}import{useMemo as ln}from"react";import sn from"react";import{createContext as un}from"@rollouthq/ui";var[pn,Xo]=un({name:"RolloutAllowedAppsContextProvider"});function Jo(o){let{children:t,...r}=o,n=ln(()=>r,Object.values(r));return sn.createElement(pn,{value:n},t)}import{useEffect as mn}from"react";import{useLazyQuery as dn}from"@rollouthq/api-client-react";function Go(o){let t=dn("apps.actions");return mn(()=>{(o==null?void 0:o.appKey)!=null&&t.fetch({appKey:o.appKey})},[o==null?void 0:o.appKey]),t}import{useQuery as cn}from"@rollouthq/api-client-react";function te(o){let{allowedApps:t}=o;return cn(["apps.list"],{select:t!=null?r=>r.filter(n=>t.includes(n.key)):void 0})}import xn from"assert";import{useEffect as Cn}from"react";import{useQuery as ee}from"@rollouthq/api-client-react/";import fn from"popup-centered";import{useCallback as gn,useEffect as bn,useState as oe}from"react";import{useTRPCContext as yn}from"@rollouthq/api-client-react";function Wt(o){let[t,r]=oe(null),[n,e]=oe(),{client:l}=yn();bn(()=>{function i(s){var m;let u=s.data._rollouthq;u!=null&&u.ok?(u==null?void 0:u.type)==="credential-added"&&u.appKey===n&&u.credentialId!=null&&((m=o.onCredentialAdded)==null||m.call(o,u.credentialId)):u!=null&&u.error&&r(u.error)}return window.addEventListener("message",i,!1),()=>{window.removeEventListener("message",i)}},[n]);let a=gn(async i=>{e(i.appKey),r(null);try{let{url:s}=await l.query("oauth.getURL",{appKey:i.appKey,customParams:i.customParams});fn(s,"",{width:800,height:800})}catch{r("Woops! Something went wrong linking account.")}},[]);return{oauthPopupError:t,openOAuthPopup:a}}function Ft(o){let{appKey:t,setCredentialId:r}=o,{openOAuthPopup:n}=Wt({onCredentialAdded:s=>{r(s),a.refetch()}}),l=ee(["apps.authInfo",{appKey:t}],{enabled:t!=null}).data,a=ee(["apps.credentials",{appKey:t,authType:l==null?void 0:l.type}],{enabled:t!=null&&l!=null}),i=a.data;Cn(()=>{if(!(l==null||i==null)){if(l.type==="none"||l.type==="apiKey"&&l.singleCredentialOnly){let s=i.length>0;return xn(s,"No credentials found!"),r(i[0].id)}(l.type==="oauth1"||l.type==="oauth2")&&l.singleCredentialOnly&&(i.length===0?n({appKey:t}):r(i[0].id))}},[l,i])}import{dataAttr as oa,useToggle as ea,Spinner as ra,useAsyncMemo as na}from"@rollouthq/ui";import Z,{useMemo as kn}from"react";import _n from"react";import{st as hn}from"@rollouthq/ui";function k(o){let{apiBaseUrl:t}=dt(),{appKey:r,css:n}=o,e=`${t}/connect-react/${r}/icon`;return _n.createElement(hn.img,{key:r,src:e,css:{width:"1em",...n}})}import re,{useMemo as An}from"react";import{useQuery as In}from"@rollouthq/api-client-react";import{createContext as vn}from"@rollouthq/ui/";var[Pn,Zt]=vn({name:"RolloutEndUserProvider"});function ne(o){var n;let r=(n=In(["end-users.getInfo"]).data)==null?void 0:n.appKey;return r==null?null:re.createElement(Fn,{appKey:r},o.children)}function Fn(o){let{appKey:t}=o,r=An(()=>({appKey:t}),[t]);return re.createElement(Pn,{value:r},o.children)}import{createProxy as Sn,getPath as Dn}from"ts-object-path";function G(o,t){if(o.success)return;let r=Sn(),n=Dn(t(r));return o.error.issues.find(e=>e.path.join(".")===n.join("."))}import{Center as Kn,ComboBox as wn,ComboBoxItem as On,FormControl as Bn}from"@rollouthq/ui";import{createContext as Tn}from"@rollouthq/ui";var[ie,E]=Tn({name:"AutomationForm"});function Nn(o){var c,d;let{appKey:t}=Zt(),{apps:r,data:n,setData:e,validation:l}=E(),{action:a}=n,i=G(l,p=>p.action),s=kn(()=>{var p;return((p=r.data)==null?void 0:p.filter(f=>f.hasActions))??[]},[r.data]),u=(c=r.data)==null?void 0:c.find(p=>p.key===(a==null?void 0:a.appKey)),{shouldShowErrors:m}=S();return Z.createElement("div",{className:"rollout-automation-form__action-app"},Z.createElement("div",{style:{display:"none"}},(d=r.data)==null?void 0:d.map(p=>Z.createElement(k,{key:p.key,appKey:p.key}))),Z.createElement(Bn,{error:m?i==null?void 0:i.message:void 0},Z.createElement(wn,{"aria-label":"Action dropdown",defaultItems:s,selectedOption:u,isDisabled:o.isDisabled,icon:u==null?void 0:Z.createElement(k,{appKey:u.key}),inputPlaceholder:"Select app",menuTrigger:"focus",onSelectionChange:p=>e(f=>{var A;if(p==null)return{...f,action:void 0};let x=p.key===t,_=((A=f.trigger)==null?void 0:A.appKey)===t,F=x&&_||!x&&!_;return{...f,action:{appKey:p.key,inputParams:{}},trigger:F?void 0:f.trigger}})},p=>Z.createElement(On,{key:p._comboboxKey,textValue:p.name},Z.createElement(Kn,{className:"rollout-listbox__option-icon"},Z.createElement(k,{appKey:p.key})),p.name))))}function St(o){return Z.createElement(Nn,{isDisabled:o.disabled})}import de,{useCallback as oi}from"react";import{useQuery as ei}from"@rollouthq/api-client-react/";import Vn from"assert";import R,{useEffect as jn,useMemo as Qn,useRef as se,useState as co}from"react";import{useMutation as zn,useQuery as Un}from"@rollouthq/api-client-react";import rt,{useEffect as Rn,useState as Yt}from"react";import{useMutation as Ln}from"@rollouthq/api-client-react";import{Spinner as Mn}from"@rollouthq/ui";import Dt,{forwardRef as En}from"react";import{TextField as $n}from"@rollouthq/ui";var ae=En((o,t)=>{let{isTestingConnection:r,value:n,onChange:e}=o,{infoHTML:l,label:a,placeholder:i}=o.definition;return Dt.createElement("div",null,Dt.createElement("label",{className:"rollout-automation-form__api-token-input-label"},a),l!=null&&Dt.createElement("div",{dangerouslySetInnerHTML:{__html:l},className:"rollout-automation-form__api-token-input-info"}),Dt.createElement("div",null,Dt.createElement($n,{ref:t,className:"rollout-automation-form__api-token-input","aria-label":"Token input text field",isDisabled:r,placeholder:i,value:n,onChange:e})))});function le(o){let{appKey:t,saveApiToken:r,authType:n,firstApiTokenInput:e,openOAuthPopup:l,closeModal:a,savingApiToken:i}=o,[s,u]=Yt({}),[m,c]=Yt(!1),[d,p]=Yt(!1),[f,x]=Yt(!1),_=Ln("credentials.test-connection"),C=v();Rn(()=>{m&&(c(!1),p(!1))},[s]);function v(){return"customParams"in n&&n.customParams!=null?n.customParams.every(B=>(s==null?void 0:s[B.key])!=null):!0}function F(){x(!0),_.mutate({appKey:t,apiToken:s},{onSuccess:B=>{c(!0),p(B),x(!1)}})}function A(){var B;if(n==null)return null;if("customParams"in n)return(B=n.customParams)==null?void 0:B.map((V,q)=>rt.createElement(ae,{key:q,ref:q===0?e:void 0,definition:V,value:(s==null?void 0:s[V.key])??"",onChange:y=>u({...s,[V.key]:y}),isTestingConnection:f}))}let $=()=>{l({appKey:t,customParams:s}),x(!1),a()},O=()=>{d&&s!=null?r(s):F()};return rt.createElement("div",{className:"rollout-automation-form__api-token-input-container"},A(),(n==null?void 0:n.type)==="apiKey"?rt.createElement("div",{className:"rollout-automation-form__api-token-apitoken-button-container"},rt.createElement("button",{type:"button","aria-label":"Save button",disabled:!C||f||i,className:`rollout-button--primary ${f?"rollout-automation-form__api-token-test-button":"rollout-automation-form__api-token-save-button"}`,onClick:O},(f||i)&&rt.createElement(Mn,null),m&&d?"Save":f?"Testing Connection ...":"Test Connection"),m&&rt.createElement("span",{className:"rollout-automation-form__api-token-connection-result"},d?"\u2705 Connection Success":"\u26A0\uFE0F Woops! Check your credentials")):rt.createElement("button",{type:"button","aria-label":"Save button",disabled:!C||f||i,className:"rollout-button--primary",onClick:$},"Add account"))}import{Avatar as ue,Center as qn,ComboBox as Wn,ComboBoxItem as pe,dataAttr as Zn,FormControl as Yn,GoogleSignIn as Hn,GreenPlus as Xn,Person as Jn,Plus as Gn}from"@rollouthq/ui";var me={id:"ADD_OPTION",label:"Add new account",avatar:void 0,icon:R.createElement(Gn,null)};function ti(o){let{isDisabled:t,appKey:r,setCredentialId:n,credentialId:e,authInfoQuery:l,error:a}=o,{shouldShowErrors:i}=S(),[s,u]=co(!1),[m,c]=co(!1),d=zn("credentials.add-api-token"),p=Un(["apps.credentials",{appKey:r}]),f=se(null),x=se(null),[_,C]=co(!1),{openOAuthPopup:v,oauthPopupError:F}=Wt({onCredentialAdded:y=>{n(y),p.refetch()}});jn(()=>{u(F!=null)},[F]);let A=Qn(()=>[...p.data??[],me],[p.data]),$=A.find(y=>y.id===e),O=_?R.createElement(Xn,null):$&&$.avatar!=null?R.createElement(ue,{src:$.avatar,name:$.label,alt:$.label}):R.createElement(Jn,null);function B(y){y!=null&&(c(!0),d.mutate({appKey:r,credential:y},{onSuccess:b=>{var j;C(!1),p.refetch(),(j=x.current)==null||j.blur(),n(b),c(!1)},onError:()=>c(!1)}))}let V=A,q=V.find(y=>y.id===e);return R.createElement("div",{className:"rollout-automation-form__credentials","data-avatar":!0,"data-selected":Zn(($==null?void 0:$.avatar)!=null)},R.createElement(Yn,{error:i?a==null?void 0:a.message:void 0},R.createElement(Wn,{"aria-label":"Account dropdown",customRef:x,defaultItems:V,selectedOption:q,menuTrigger:"focus",icon:O,isDisabled:t,isLoading:p.isFetching||l.isFetching,inputPlaceholder:_?"Connect new account":"Select account",onSelectionChange:y=>{if(y==null)return n(void 0);let b=l.data,j=y===me;if(Vn(b!=null,"No app auth info"),j){(b.type==="oauth1"||b.type==="oauth2")&&(b.customParams!=null?(C(!0),setTimeout(()=>{var Y;return(Y=f.current)==null?void 0:Y.focus()})):v({appKey:r})),b.type==="apiKey"&&(C(!0),setTimeout(()=>{var Y;return(Y=f.current)==null?void 0:Y.focus()})),u(!1);return}u(!1),C(!1),n(y.id)}},y=>(r==="gmail"||r==="googleCalendar"||r==="googleDocs"||r==="googleSheets")&&y.id==="ADD_OPTION"?R.createElement(pe,{key:y._comboboxKey,textValue:y.label},R.createElement(Hn,null)):R.createElement(pe,{key:y._comboboxKey,textValue:y.label},R.createElement(qn,{className:"rollout-listbox__option-icon"},R.createElement(ue,{"aria-label":"Option icon",src:y.avatar,name:"icon"in y?null:y.label,alt:y.label,icon:"icon"in y?y.icon:void 0})),y.label))),s&&R.createElement("div",{className:"rollout-automation-form-oauth__error__message"},F??"Oops! Couldn't link that account."),_&&l.data!=null&&R.createElement(le,{appKey:r,authType:l.data,saveApiToken:B,savingApiToken:m,credentialId:e,firstApiTokenInput:f,openOAuthPopup:v,closeModal:()=>C(!1)}))}function nt(o){let{appKey:t,authInfoQuery:r,credentialId:n,error:e,setCredentialId:l,isDisabled:a}=o,i=r.data;return i==null||(i.type==="oauth1"||i.type==="oauth2"||i.type==="apiKey")&&i.singleCredentialOnly||i.type==="none"?null:R.createElement(ti,{appKey:t,authInfoQuery:r,credentialId:n,setCredentialId:l,error:e,isDisabled:a})}function ri(o){let{appKey:t,credentialId:r,setCredentialId:n,error:e,isDisabled:l}=o,a=ei(["apps.authInfo",{appKey:t}]);return a.data==null?null:de.createElement(nt,{appKey:t,authInfoQuery:a,credentialId:r,setCredentialId:n,error:e,isDisabled:l})}function Tt(o){let{data:t,setData:r,validation:n}=E(),{action:e}=t,l=oi(a=>r(i=>({...i,action:{...i.action,credentialId:a}})),[]);return(e==null?void 0:e.actionKey)==null?null:de.createElement(ri,{appKey:e.appKey,credentialId:e.credentialId,setCredentialId:l,error:n.success?void 0:n.error.issues.find(a=>a.path.join(".")==="action.credentialId"),isDisabled:o.disabled})}import it from"react";import{Center as ni,ComboBox as ii,ComboBoxItem as ai,FormControl as li}from"@rollouthq/ui";function si(o){var d;let{data:t,setData:r,actions:n,validation:e}=E(),{shouldShowErrors:l,setShouldShowErrors:a}=S(),s=(()=>e.success?null:e.error.issues.find(p=>p.path.join(".")==="action.actionKey"))(),u=t.action!=null?it.createElement(k,{appKey:t.action.appKey}):void 0,m=n.data??[],c=(d=n.data)==null?void 0:d.find(p=>{var f;return p.key===((f=t.action)==null?void 0:f.actionKey)});return it.createElement("div",{className:"rollout-automation-form__action-action"},it.createElement(li,{error:l?s==null?void 0:s.message:void 0},it.createElement(ii,{"aria-label":"Action dropdown",defaultItems:m,selectedOption:c,isDisabled:o.isDisabled,icon:u,isLoading:n.isLoading,inputPlaceholder:"Select action",menuTrigger:"focus",onSelectionChange:p=>(a(!1),r(f=>({...f,action:{...f.action,actionKey:p==null?void 0:p.key,inputParams:{}}})))},p=>it.createElement(ai,{key:p._comboboxKey,textValue:p.name},it.createElement(ni,{className:"rollout-listbox__option-icon"},u),p.name))))}function kt(o){return it.createElement(si,{isDisabled:o.disabled})}import ki from"assert";import bt from"react";import gt,{useCallback as Di}from"react";import{useTRPCContext as Ti}from"@rollouthq/api-client-react";import wt from"react";import{createProxy as _i}from"ts-object-path";import{useQuery as hi}from"@rollouthq/api-client-react";import Kt from"react";import{unreachableCase as bi}from"ts-assert-unreachable";import ui from"react";import{TextField as pi}from"@rollouthq/ui/";function ce(o){return ui.createElement(pi,{className:"rollout-input",value:o.value??"",onChange:o.setValue,isDisabled:o.isDisabled})}import fe from"react";import{resolveMentions as mi}from"@rollouthq/common";import{RichEditor as di}from"@rollouthq/ui";function ge(o){let t=o.value&&mi(o.value,o.variables);return fe.createElement("div",{className:"rollout-rich-text-input"},fe.createElement(di,{value:t??null,setValue:r=>o.setValue(r??void 0),formattingEnabled:!1,linksEnabled:!1,mentionVariables:o.variables,isDisabled:o.isDisabled}))}import{createContext as yi}from"@rollouthq/ui/";import be from"react";import{ComboBox as ci,ComboBoxItem as fi,useAsyncMemo as gi}from"@rollouthq/ui";function ye(o){let{def:t,value:r,setValue:n,getDynamicOptions:e}=o,a=gi(async()=>{var s;return((s=t.dropdownConfiguration)==null?void 0:s.type)==="static"?t.dropdownConfiguration.staticOptions.map(u=>({key:u,label:u})):await e({inputKey:t.key})},[JSON.stringify(t.dropdownConfiguration)]).value??[],i=a.find(s=>s.key===r);return be.createElement(ci,{defaultItems:a,selectedOption:i,menuTrigger:"focus",icon:null,inputPlaceholder:"Select option",onSelectionChange:s=>{n(s==null?void 0:s.key)},isDisabled:o.isDisabled},s=>be.createElement(fi,{key:s._comboboxKey,textValue:s.label},s.label))}var[xi,Ci]=yi({name:"InputDefRenderer"});function Ce(o){let{renderInputParams:t}=w(),r=T({defaultField:xe,renderer:t==null?void 0:t[o.def.key],ctx:{InputParamField:xe}});return Kt.createElement(xi,{value:o},r)}function xe(o){let t=Ci(),{def:r,value:n,setValue:e,variables:l,getDynamicOptions:a}=t;function i(){if(r.type==="plainText")return Kt.createElement(ce,{def:r,value:n,setValue:e,isDisabled:o.disabled});if(r.type==="dropdown")return Kt.createElement(ye,{def:r,value:n,setValue:e,getDynamicOptions:a,isDisabled:o.disabled});if(r.type==="string")return Kt.createElement(ge,{def:r,value:n,setValue:e,variables:l,isDisabled:o.disabled});bi(r)}return Kt.createElement(zt,{label:r.label,isRequired:!0,error:void 0},i())}var Ai=_i();function at(o){let{api:t,credentialId:r,inputParams:n,setInputParams:e,importedData:l,variables:a,getDynamicOptions:i}=o;return wt.createElement(No,{value:o},"Component"in l?wt.createElement(l.Component,{b:Ai,credentialId:r,inputParams:n,setInputParams:e,api:t,useQuery:hi,inputComponents:et}):wt.createElement(wt.Fragment,null,l.inputParamDefs.map(s=>wt.createElement(Ce,{key:s.key,def:s,value:n[s.key],setValue:u=>e({...n,[s.key]:u}),variables:a,getDynamicOptions:i}))))}import Ii,{useLayoutEffect as vi}from"react";import{useEffect as Pi,useState as Fi}from"react";import{isVariable as Si,z as _e}from"@rollouthq/common";var he=typeof document>"u"?Pi:vi;function ft(o){let{actionRef:t}=o,{apiBaseUrl:r}=dt(),[n,e]=Fi();return he(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:_e},react:Ii,["@rollouthq/common"]:{z:_e,isVariable:Si},["@rollouthq/connect-react/components/action-inputs"]:et}})},[]),he(()=>{if(t!=null){let{appKey:l,actionKey:a}=t;if(!l||!a)return;let i=`${r}/connect-react/${l}/actions/${a}.js`;new Function("path","return import(path)")(i).then(u=>e(u))}},[t==null?void 0:t.appKey,t==null?void 0:t.actionKey]),n}function Ae(){return gt.createElement("div",{className:"rollout-automation-form__action-inputs"},gt.createElement("div",null,gt.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),gt.createElement(fo,null)))}function fo(){let{client:o}=Ti(),{data:t,setData:r,variables:n,renderFields:e}=E(),l=t.action,a=ft({actionRef:t.action}),i=Di(u=>{r(m=>({...m,action:{...m.action,inputParams:u}}))},[r]);if(a==null||l.credentialId==null)return null;let s=typeof(e==null?void 0:e.action)=="object"?e.action.inputParams:void 0;return gt.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},gt.createElement(at,{api:o,credentialId:l.credentialId,inputParams:l.inputParams,setInputParams:i,renderInputParams:s,importedData:a,variables:n,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}}))}function go(){var a,i,s;let{data:o,renderFields:t}=E(),{action:r}=o;ki(typeof(t==null?void 0:t.action)!="function"&&typeof(t==null?void 0:t.action)!="boolean");let n=T({defaultField:St,renderer:(a=t==null?void 0:t.action)==null?void 0:a.appKey,ctx:{ActionAppKeyField:St}}),e=T({defaultField:kt,renderer:(i=t==null?void 0:t.action)==null?void 0:i.actionKey,ctx:{ActionKeyField:kt}}),l=T({defaultField:Tt,renderer:(s=t==null?void 0:t.action)==null?void 0:s.credentialId,ctx:{ActionCredentialIdField:Tt}});return bt.createElement(bt.Fragment,null,bt.createElement("div",{className:"rollout-automation-form__action"},bt.createElement("div",{className:"rollout-automation-form__label"},"Select action"),bt.createElement("div",{className:"rollout-automation-form__helper-text"},"This is what your automation will do when triggered"),n,e,l),(r==null?void 0:r.actionKey)!=null&&r.credentialId!=null&&bt.createElement(Ae,null))}import qi from"assert";import tt,{useCallback as Pe,useMemo as Wi}from"react";import{useTRPCContext as Zi}from"@rollouthq/api-client-react";import H from"react";import{useQuery as Ki}from"@rollouthq/api-client-react";import{Center as wi,ComboBox as Oi,ComboBoxItem as Bi,FormControl as Ni,Rocket as Ei}from"@rollouthq/ui";function $i(o){let{appKey:t}=Zt(),{data:r,setData:n,validation:e,mode:l}=E(),{trigger:a}=r,i=Ki([l==="task"?"triggers.taskApps":"triggers.apps"]),{shouldShowErrors:s}=S(),u=G(e,d=>d.trigger),m=i.data??[],c=m==null?void 0:m.find(d=>d.key===(a==null?void 0:a.appKey));return H.createElement("div",{className:"rollout-automation-form__trigger-app"},H.createElement(Ni,{error:s?u==null?void 0:u.message:void 0},H.createElement(Oi,{"aria-label":"Trigger app dropdown",defaultItems:m,selectedOption:c,menuTrigger:"focus",icon:a==null?H.createElement(Ei,null):H.createElement(k,{appKey:a.appKey}),isDisabled:o.isDisabled,inputPlaceholder:"Select app",onSelectionChange:d=>n(p=>{var F;if(d==null)return{...p,trigger:void 0};let f=d.key===t,x=((F=p.action)==null?void 0:F.appKey)===t,v=f&&x||!f&&!x;return{...p,trigger:{appKey:d.key,inputParams:{}},action:v?void 0:p.action}})},d=>H.createElement(Bi,{key:d._comboboxKey,textValue:d.name},H.createElement(wi,{className:"rollout-listbox__option-icon"},H.createElement(k,{appKey:d.key})),d.name))))}function Ot(o){return H.createElement($i,{isDisabled:o.disabled})}import X from"react";import{useQuery as Ri}from"@rollouthq/api-client-react";import{Center as Li,ComboBox as Mi,ComboBoxItem as Vi,FormControl as ji,Rocket as Ie}from"@rollouthq/ui";function Qi(o){let{isDisabled:t}=o,{shouldShowErrors:r}=S(),{validation:n,data:e,setData:l,mode:a}=E(),{trigger:i}=e,s=Ri(["apps.triggers",{appKey:i==null?void 0:i.appKey,isTask:a==="task"}],{enabled:(i==null?void 0:i.appKey)!=null}),u=G(n,d=>d.trigger.triggerKey),m=s.data??[],c=m.find(d=>d.key===(i==null?void 0:i.triggerKey));return X.createElement(ji,{error:r?u==null?void 0:u.message:void 0},X.createElement(Mi,{"aria-label":"Trigger dropdown",defaultItems:m,selectedOption:c,menuTrigger:"focus",isDisabled:t||s.isLoading,icon:(i==null?void 0:i.appKey)==null?X.createElement(Ie,null):X.createElement(k,{appKey:i==null?void 0:i.appKey}),inputPlaceholder:"Select trigger",onSelectionChange:d=>l(p=>({...p,trigger:{...p.trigger,triggerKey:d==null?void 0:d.key,inputParams:{}}}))},d=>X.createElement(Vi,{key:d._comboboxKey,textValue:d.name},X.createElement(Li,{className:"rollout-listbox__option-icon"},(i==null?void 0:i.appKey)==null?X.createElement(Ie,null):X.createElement(k,{appKey:i==null?void 0:i.appKey})),d.name)))}function Bt(o){return X.createElement(Qi,{isDisabled:o.disabled})}import zi from"react";import{useQuery as Ui}from"@rollouthq/api-client-react";function ve(o){let{appKey:t,credentialId:r,setCredentialId:n,error:e,isDisabled:l}=o,a=Ui(["apps.authInfo",{appKey:t}]);return a.data==null?null:zi.createElement(nt,{appKey:t,authInfoQuery:a,credentialId:r,setCredentialId:n,error:e,isDisabled:l})}function bo(){var f,x,_;let{client:o}=Zi(),{data:t,setData:r,renderFields:n,validation:e,mode:l}=E(),{trigger:a}=t,i=ct({...a,isTask:l==="task"}),s=Pe(C=>{r(v=>({...v,trigger:{...v.trigger,inputParams:C}}))},[r]),u=Pe(C=>r(v=>({...v,trigger:{...v.trigger,credentialId:C}})),[r]),m=Wi(()=>[],[]);qi(typeof(n==null?void 0:n.trigger)!="function"&&typeof(n==null?void 0:n.trigger)!="boolean");let c=T({defaultField:Ot,renderer:(f=n==null?void 0:n.trigger)==null?void 0:f.appKey,ctx:{TriggerAppKeyField:Ot}}),d=T({defaultField:Bt,renderer:(x=n==null?void 0:n.trigger)==null?void 0:x.triggerKey,ctx:{TriggerKeyField:Bt}}),p=i&&("inputParamsSchema"in i?Object.keys(i.inputParamsSchema.shape).length>0:i.inputParamDefs.length>0);return tt.createElement("div",{className:"rollout-automation-form__trigger"},tt.createElement("div",{className:"rollout-automation-form__label"},"Select trigger"),tt.createElement("div",{className:"rollout-automation-form__helper-text"},"This is the event that will kick off your action"),c,tt.createElement("div",{className:"rollout-automation-form__trigger-trigger"},d),(a==null?void 0:a.triggerKey)!=null&&tt.createElement(ve,{appKey:a.appKey,credentialId:a.credentialId,setCredentialId:u,error:e.success?void 0:e.error.issues.find(C=>C.path.join(".")==="trigger.credentialId")}),(a==null?void 0:a.credentialId)!=null&&p&&tt.createElement("div",{className:"rollout-automation-form__trigger-inputs"},tt.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},tt.createElement(at,{api:o,credentialId:a.credentialId,inputParams:a.inputParams,setInputParams:s,renderInputParams:(_=n==null?void 0:n.trigger)==null?void 0:_.inputParams,importedData:i,variables:m,getDynamicOptions:({inputKey:C})=>o.query("triggers.getTriggerInputOptions",{triggerKey:a.triggerKey,inputKey:C})}))))}import Fe from"react";import{TextField as Yi}from"@rollouthq/ui";function Hi(o){let{disabled:t=!1}=o,{data:r,setData:n,validation:e}=E(),{shouldShowErrors:l}=S(),a=G(e,i=>i.name)!=null;return Fe.createElement(Yi,{"aria-label":"Automation Name Input",className:"rollout-automation-form__name",placeholder:"Give your automation a name",isDisabled:t,value:r.name??"",validationState:l&&a?"invalid":"valid",onChange:i=>n(s=>({...s,name:i}))})}function yo(o){return Fe.createElement(Hi,{...o})}import{useMemo as Se}from"react";import{z}from"zod";var yt=z.object({name:z.string().min(1),trigger:z.object({appKey:z.string(),triggerKey:z.string(),credentialId:z.string(),inputParams:z.object({})}),action:z.object({appKey:z.string(),actionKey:z.string(),credentialId:z.string(),inputParams:z.object({})})});function De(o){let{data:t,actionInputParamsSchema:r,triggerInputParamsSchema:n}=o,e=Se(()=>yt.extend({trigger:yt.shape.trigger.extend({inputParams:n}),action:yt.shape.action.extend({inputParams:r})}),[n,r]);return Se(()=>e.safeParse(t),[t,e])}function xt(o){var It,vt,g,I,Pt;let{data:t,isSaving:r,onSave:n,onSubmit:e,onCancel:l,onUpdate:a,onDelete:i,mode:s,renderFields:u}=o,[m,c]=Xi(!1),[d,p]=ea(),{client:f}=ta(),_=(g=Gi(["apps.triggers",{appKey:(It=t.trigger)==null?void 0:It.appKey,isTask:s==="task"}],{enabled:((vt=t.trigger)==null?void 0:vt.appKey)!=null}).data)==null?void 0:g.find(M=>{var L;return M.key===((L=t.trigger)==null?void 0:L.triggerKey)}),C=na(async()=>{var M,L,J;return _==null?[]:_.payloadConfiguration.type==="static"?_.payloadConfiguration.staticSchema:await f.query("triggers.getPayloadSchema",{appKey:(M=t.trigger)==null?void 0:M.appKey,triggerKey:(L=t.trigger)==null?void 0:L.triggerKey,inputParams:(J=t.trigger)==null?void 0:J.inputParams})},[JSON.stringify(_==null?void 0:_.payloadConfiguration),JSON.stringify(t.trigger)]),v=Nt(()=>(C.value??[]).map(M=>({id:M.key,label:M.label,type:"string"})),[C.value]),{allowedApps:F}=Xo(),A=te({allowedApps:F}),$=Go(t.action),O=ft({actionRef:t.action}),B=ct({...t.trigger,isTask:s==="task"}),V=Nt(()=>B==null?yt.shape.action.shape.inputParams:"inputParamsSchema"in B?B.inputParamsSchema:Te(B.inputParamDefs),[B]),q=Nt(()=>O==null?yt.shape.action.shape.inputParams:"inputParamsSchema"in O?O.inputParamsSchema:Te(O.inputParamDefs),[O]),y=De({data:t,triggerInputParamsSchema:V,actionInputParamsSchema:q}),b=xo(M=>a(L=>{var wo,Oo;let J=M(L),Ge=((wo=L.trigger)==null?void 0:wo.triggerKey)!==((Oo=J.trigger)==null?void 0:Oo.triggerKey),tr=J.action==null?void 0:{...J.action,inputParams:Ge?{}:J.action.inputParams};return{...J,action:tr}}),[a]),j=Nt(()=>({mode:s,data:t,apps:A,actions:$,validation:y,variables:v,setData:b,renderFields:u}),[s,t,A,$,y,v,b,u]),Y=Nt(()=>({shouldShowErrors:m,setShouldShowErrors:c}),[m,c]),oo=xo(M=>b(L=>({...L,trigger:{...L.trigger,credentialId:M}})),[b]),eo=xo(M=>b(L=>({...L,action:{...L.action,credentialId:M}})),[b]);Ft({appKey:(I=t.trigger)==null?void 0:I.appKey,setCredentialId:oo}),Ft({appKey:(Pt=t.action)==null?void 0:Pt.appKey,setCredentialId:eo});let $t=A.data==null,ro=Ji($t,{delay:500,minDuration:200});if(A.failureCount>0)return D.createElement("div",{className:"rollout-automations-list__error-msg"},"Woops! Something went wrong fetching automations.");if($t||ro)return D.createElement("div",{className:"rollout__loading_spinner_container"},D.createElement(ra,{className:"rollout__loading_spinner"}));let no=T({defaultField:yo,renderer:u==null?void 0:u.name,ctx:{NameField:yo}}),Rt=typeof(u==null?void 0:u.trigger)=="object"?D.createElement(bo,null):T({defaultField:bo,renderer:u==null?void 0:u.trigger,ctx:{TriggerAppKeyField:Ot,TriggerKeyField:Bt}}),Lt=typeof(u==null?void 0:u.action)=="object"?D.createElement(go,null):T({defaultField:go,renderer:u==null?void 0:u.action,ctx:{ActionAppKeyField:St,ActionKeyField:kt,ActionCredentialIdField:Tt,ActionInputFields:fo}}),Mt=D.createElement("button",{type:"button","aria-label":"Save button",className:"rollout-button--primary rollout-automation-form__submit","data-loading":oa(r),onClick:()=>{c(!0),y.success?n(y.data):console.error(y.error)}},r?"Saving...":"Save"),Vt=l!=null&&D.createElement("button",{type:"button","aria-label":"Cancel button",className:"rollout-button--secondary rollout-automation-form__cancel",onClick:()=>l()},"Cancel"),jt=s!=="create"&&D.createElement("div",{className:"rollout-automation-form__delete"},d&&D.createElement("div",{className:"rollout-automation-form-delete__confirm-dialog"},D.createElement("div",{className:"rollout-automation-form__delete-confirm-text"},"Are you sure you want to delete this automation?"),D.createElement("div",{className:"rollout-automation-form__delete-confirm-buttons"},D.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:p,className:"rollout-button--secondary rollout-automation-form__delete-cancel"},"No, cancel"),D.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:i,className:"rollout-button--danger rollout-automation-form__delete-confirm"},"Yes, delete"))),D.createElement("button",{type:"button","aria-label":"Delete button",className:"rollout-button--danger rollout-automations-form-delete__trigger",onClick:p},"Delete")),Qt=e!=null&&D.createElement("button",{type:"button","aria-label":"Submit button",className:"rollout-button--primary rollout-automation-form__submit",onClick:()=>{c(!0),y.success?e(y.data):console.error(y.error)}},"Submit");return D.createElement(Ut,{value:Y},D.createElement(ie,{value:j},D.createElement("div",{className:"rollout-automation-form"},D.createElement("div",{className:"rollout-automation-form__header"},no),D.createElement("div",{className:"rollout-automation-form__content"},Rt,Lt),D.createElement("div",{className:"rollout-automation-form__buttons"},s==="task"?Qt:D.createElement(D.Fragment,null,Mt,Vt,jt)))))}function Co(o){let{onAutomationCreated:t,onBeforeAutomationCreate:r,onCancel:n,prefilled:e,renderFields:l}=o,a=aa("automations.create"),[i,s]=ia(()=>{var c,d;let m={};return e==null||(e.name&&(m.name=e.name),((c=e.trigger)==null?void 0:c.appKey)!=null&&(m.trigger={...e.trigger,appKey:e.trigger.appKey,inputParams:e.trigger.inputParams??{}}),((d=e.action)==null?void 0:d.appKey)!=null&&(m.action={...e.action,appKey:e.action.appKey,inputParams:e.action.inputParams??{}})),m}),u=async m=>{let c=await(r==null?void 0:r({automationData:m}));if(c===!1)return;let d=c===!0||c===void 0?m:c.automationData,p=await a.mutateAsync(d);t({automation:p})};return ke.createElement("div",{className:"rollout-automation-creator"},ke.createElement(xt,{mode:"create",data:i,renderFields:l,onUpdate:s,isSaving:a.isLoading,onSave:u,onCancel:n}))}import _o,{useState as la}from"react";import{useMutation as Ke,useQuery as sa,useTRPCContext as ua}from"@rollouthq/api-client-react";function ho(o){let{automationId:t,onAutomationDeleted:r,onAutomationUpdated:n,onCancel:e,renderFields:l}=o,{invalidateQueries:a}=ua(),i=Ke("automations.delete",{onSuccess:()=>a(["automations.list"])}),[s,u]=la({}),m=sa(["automations.get",{automationId:t}],{onSuccess(f){f!=null&&u({name:f.name,action:f.action,trigger:f.trigger})}}),c=Ke("automations.update");if(m.isLoading)return null;if(m.data==null)return _o.createElement("div",{className:"rollout-automations-editor__not-found"},"Automation not found");let d=async f=>{let x=await c.mutateAsync({id:t,automationData:{name:f.name,action:f.action,trigger:f.trigger}});n==null||n(x)},p=()=>{i.mutate({id:m.data.id},{onSuccess:()=>{r==null||r()}})};return _o.createElement("div",{className:"rollout-automation-editor"},_o.createElement(xt,{mode:"edit",data:s,renderFields:l,onUpdate:u,isSaving:c.isLoading,onSave:d,onDelete:p,onCancel:e}))}import lt,{useState as va}from"react";import Ct,{useEffect as xa,useState as Ca}from"react";import{useMutation as _a,useQuery as ha,useTRPCContext as Aa}from"@rollouthq/api-client-react";import{matchSorter as we}from"match-sorter";import P,{useEffect as pa,useState as Ne}from"react";import{isChildofInteractiveElement as ma,Center as Oe,Search as da,TextField as ca,Spinner as fa,dataAttr as Be}from"@rollouthq/ui";import{useToggle as ga,Trash as ba}from"@rollouthq/ui";function Ee(o){let{automations:t,isLoading:r=!1,isDeleting:n=!1,onEditAutomation:e,onDeleteAutomation:l}=o,[a,i]=Ne(""),s=we(t,a,{keys:["name","action.app.name"],threshold:we.rankings.ACRONYM}),u=s.length===0;return P.createElement("div",{className:"rollout-automations-list__container"},P.createElement("div",{className:"rollout-automations-list__search-input__group"},P.createElement("div",{className:"rollout-automations-list__search-input__left-element"},P.createElement(da,null)),P.createElement(ca,{"aria-label":"Search automations text field",placeholder:"Search automations",value:a,onChange:i,className:"rollout-automations-list__search-input"})),r&&P.createElement("div",{className:"rollout__loading_spinner_container"},P.createElement(fa,{className:"rollout__loading_spinner"})),!r&&u&&P.createElement("div",{className:"rollout-automations-list__empty-msg"},"No automations found"),P.createElement("div",{className:"rollout-automations-list__list"},s.map(m=>P.createElement(ya,{key:m.id,automation:m,onEdit:()=>e(m),onDelete:()=>l(m),isDeleting:n}))))}function ya(o){let{automation:t,onEdit:r,onDelete:n,isDeleting:e}=o,[l,a]=ga(),[i,s]=Ne(!1);pa(()=>{!e&&i&&s(!1)},[e]);let u=l&&P.createElement("div",{className:"rollout-automations-list-item__options__content",onMouseLeave:()=>{l&&a()}},P.createElement("span",null,"Really delete?"),P.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:()=>{n(),s(!0)},className:"rollout-automations-list-item__options__delete-item-btn"},"Delete"),P.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:a,className:"rollout-automations-list-item__options__cancel-item-btn"},"Cancel"));return P.createElement("div",{className:"rollout-automations-list__item-wrapper","data-deleting":Be(i)},u,P.createElement("div",{className:"rollout-automations-list__item",role:"group","data-open":Be(l),onClick:m=>{ma(m.target)||r()}},P.createElement("div",{className:"rollout-automations-list-item__header"},P.createElement("div",{className:"rollout-automations-list-item__icons"},P.createElement(Oe,{className:"rollout-automations-list-item__trigger"},P.createElement(k,{appKey:t.trigger.appKey})),P.createElement(Oe,{className:"rollout-automations-list-item__action"},P.createElement(k,{appKey:t.action.appKey}))),P.createElement("div",{role:"button",className:"rollout-automations-list-item__options__trigger",onClick:a},P.createElement(ba,null))),P.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}import{Plus as Ia}from"@rollouthq/ui";function Ao(o){let{onEditAutomation:t,onCreateAutomation:r,filter:n}=o,{invalidateQueries:e}=Aa(),[l,a]=Ca(()=>[]),i=ha(["automations.list"]);xa(()=>{i.data!=null&&(n!=null?a(i.data.filter(u=>{try{return n(u)}catch(m){return console.error(m),!1}})):a(i.data))},[i.data,n]);let s=_a("automations.delete",{onSuccess:()=>e(["automations.list"])});return Ct.createElement("div",null,Ct.createElement("div",{className:"rollout-automations-list__header"},Ct.createElement("span",{className:"rollout-automations-list__header-title"},"My automations"),Ct.createElement("button",{type:"button","aria-label":"New automation button",className:"rollout-automations-list__new-btn",onClick:()=>r()},Ct.createElement(Ia,null),"New")),Ct.createElement(Ee,{automations:l??[],isLoading:i.isFetching,isDeleting:s.isLoading,onDeleteAutomation:u=>s.mutate({id:u.id}),onEditAutomation:t}))}import{ArrowBack as Pa}from"@rollouthq/ui";function Fa(o){let{onAutomationCreated:t,onBeforeAutomationCreate:r,prefilled:n,filter:e,renderFields:l}=o,[a,i]=va({mode:"LIST"});return lt.createElement("div",{className:"rollout-automations-manager"},a.mode==="LIST"&&lt.createElement(Ao,{onEditAutomation:s=>i({mode:"EDIT",automationId:s.id}),onCreateAutomation:()=>i({mode:"CREATE"}),filter:e}),(a.mode==="CREATE"||a.mode==="EDIT")&&lt.createElement("div",{className:"rollout-automations-manager__navbar"},lt.createElement("button",{type:"button","aria-label":"Return to automations list button",className:"rollout-automations-manager__back-btn",onClick:()=>i({mode:"LIST"})},lt.createElement(Pa,{className:"rollout-automation-form__header-back__arrow"}))),a.mode==="CREATE"&&lt.createElement(Co,{onBeforeAutomationCreate:r,onAutomationCreated:s=>{t==null||t(s),i({mode:"LIST"})},prefilled:n,renderFields:l}),a.mode==="EDIT"&&lt.createElement(ho,{automationId:a.automationId,onAutomationUpdated:()=>i({mode:"LIST"}),onAutomationDeleted:()=>i({mode:"LIST"}),renderFields:l}))}import h,{useCallback as Io,useEffect as Le,useMemo as Et,useState as Me}from"react";import{useSpinDelay as Sa}from"spin-delay";import{useLazyQuery as Ht,useMutation as Ve,useQuery as je,useTRPCContext as Da}from"@rollouthq/api-client-react";import{inputDefToZodObject as Qe}from"@rollouthq/common/";import{Center as ze,FormControl as Ta,Spinner as ka,useAsyncMemo as Ka}from"@rollouthq/ui";import{useMemo as $e}from"react";import{z as U}from"zod";var _t=U.object({name:U.string().min(1),trigger:U.object({appKey:U.string(),triggerKey:U.string(),credentialId:U.string(),inputParams:U.object({})}),action:U.object({appKey:U.string(),actionKey:U.string(),credentialId:U.string(),inputParams:U.object({})})});function Re(o){let{data:t={},actionInputParamsSchema:r,triggerInputParamsSchema:n}=o,e=$e(()=>_t.extend({trigger:_t.shape.trigger.extend({inputParams:n}),action:_t.shape.action.extend({inputParams:r})}),[r,n]);return $e(()=>e.safeParse(t),[t,e])}function vo(o){var Rt,Lt,Mt,Vt,jt,Qt,It,vt;let{blueprintId:t}=o,{client:r,invalidateQueries:n}=Da(),[e,l]=Me(),a=Ht("triggers.getPayloadSchema"),i=Ht("apps.authInfo"),s=Ht("apps.triggers"),u=ct(e==null?void 0:e.trigger);Le(()=>{let g=e==null?void 0:e.trigger;g!=null&&(i.fetch({appKey:g.appKey}),s.fetch({appKey:g.appKey}),g.triggerKey!=null&&g.appKey!=null&&a.fetch({appKey:g.appKey,triggerKey:g.triggerKey}))},[e==null?void 0:e.trigger]);let m=Ht("apps.authInfo");Le(()=>{var g;((g=e==null?void 0:e.action)==null?void 0:g.appKey)!=null&&m.fetch({appKey:e.action.appKey})},[(Rt=e==null?void 0:e.action)==null?void 0:Rt.appKey]);let c=je(["blueprints.get",{blueprintId:t}],{onSuccess:g=>{e==null&&(g.automation!=null?l({name:g.automation.name,action:g.automation.action,trigger:g.automation.trigger}):l({name:g.name,action:g.action,trigger:g.trigger}))}}),d=Ve("blueprints.createAutomation"),p=Ve("blueprints.deactivateAutomation"),f=Et(()=>u==null?_t.shape.action.shape.inputParams:"inputParamsSchema"in u?u.inputParamsSchema:Qe(u.inputParamDefs),[u]),x=ft({actionRef:e==null?void 0:e.action}),_=Et(()=>x==null?_t.shape.action.shape.inputParams:"inputParamsSchema"in x?x.inputParamsSchema:Qe(x.inputParamDefs),[x]),C=Re({data:e,triggerInputParamsSchema:f,actionInputParamsSchema:_}),v=Io(g=>l(I=>({...I,trigger:{...I==null?void 0:I.trigger,credentialId:g}})),[l]),F=Io(g=>l(I=>({...I,action:{...I==null?void 0:I.action,credentialId:g}})),[l]);Ft({appKey:(Lt=e==null?void 0:e.trigger)==null?void 0:Lt.appKey,setCredentialId:v});let A=Io(g=>{l(I=>({...I,trigger:{...I.trigger,inputParams:g}}))},[l]),O=(jt=je(["apps.triggers",{appKey:(Mt=e==null?void 0:e.trigger)==null?void 0:Mt.appKey}],{enabled:((Vt=e==null?void 0:e.trigger)==null?void 0:Vt.appKey)!=null}).data)==null?void 0:jt.find(g=>{var I;return g.key===((I=e==null?void 0:e.trigger)==null?void 0:I.triggerKey)}),B=Ka(async()=>{var g,I,Pt;return O==null?[]:O.payloadConfiguration.type==="static"?O.payloadConfiguration.staticSchema:await r.query("triggers.getPayloadSchema",{appKey:(g=e==null?void 0:e.trigger)==null?void 0:g.appKey,triggerKey:(I=e==null?void 0:e.trigger)==null?void 0:I.triggerKey,inputParams:(Pt=e==null?void 0:e.trigger)==null?void 0:Pt.inputParams})},[JSON.stringify(O==null?void 0:O.payloadConfiguration),JSON.stringify(e==null?void 0:e.trigger)]),V=Et(()=>(B.value??[]).map(g=>({id:g.key,label:g.label,type:"string"})),[B.value]);function q(){return(e==null?void 0:e.action)==null||x==null?null:h.createElement("div",{className:"rollout-automation-form__action-inputs"},h.createElement("div",null,h.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),h.createElement("div",{className:"rollout-automation-form__credential"},h.createElement(Ta,{label:"Account",isRequired:!0},h.createElement(nt,{error:C.success?void 0:C.error.issues.find(g=>g.path.join(".")==="action.credentialId"),credentialId:e.action.credentialId,setCredentialId:g=>{let I={...e.action,credentialId:g};l({...e,action:I})},authInfoQuery:m,appKey:e.action.appKey}))),h.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},h.createElement(at,{isBlueprintActivation:!0,api:r,credentialId:e.action.credentialId,inputParams:e.action.inputParams,setInputParams:g=>l({...e,action:{...e.action,inputParams:g}}),renderInputParams:void 0,importedData:x,variables:V,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}}))))}let y=((It=(Qt=c.data)==null?void 0:Qt.automation)==null?void 0:It.active)??!1,[b,j]=Me(!1),Y=Et(()=>({shouldShowErrors:b,setShouldShowErrors:j}),[b,j]),oo=Et(()=>[],[]);async function eo(){if(j(!0),C.success){let g=C.data;await d.mutateAsync({blueprintId:t,trigger:{credentialId:g.trigger.credentialId,inputParams:g.trigger.inputParams},action:{credentialId:g.action.credentialId,inputParams:g.action.inputParams}}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}else console.log(e),console.error(C.error)}async function $t(){await p.mutateAsync({blueprintId:t}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}let ro=Sa(e==null,{delay:500,minDuration:200});if(e==null)return null;if(ro)return h.createElement("div",{className:"rollout__loading_spinner_container"},h.createElement(ka,{className:"rollout__loading_spinner"}));let Ko=u&&("inputParamsSchema"in u?Object.keys(u.inputParamsSchema.shape).length>0:u.inputParamDefs.length>0),no=((vt=e.trigger)==null?void 0:vt.triggerKey)!=null&&h.createElement("div",{className:"rollout-blueprint-activator__trigger"},h.createElement("div",{className:"rollout-blueprint-activator__label"},"Set up trigger"),h.createElement("div",{className:"rollout-blueprint-activator__trigger__fields"},h.createElement(nt,{error:C.success?void 0:C.error.issues.find(g=>g.path.join(".")==="trigger.credentialId"),appKey:e.trigger.appKey,setCredentialId:g=>l({...e,trigger:{...e.trigger,credentialId:g}}),authInfoQuery:i,credentialId:e.trigger.credentialId}),e.trigger.credentialId!=null&&Ko&&h.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},h.createElement(at,{api:r,credentialId:e.trigger.credentialId,inputParams:e.trigger.inputParams,setInputParams:A,renderInputParams:void 0,importedData:u,variables:oo,getDynamicOptions:({inputKey:g})=>{var I;return r.query("triggers.getTriggerInputOptions",{triggerKey:(I=e.trigger)==null?void 0:I.triggerKey,inputKey:g})}}))));return h.createElement(Ut,{value:Y},h.createElement("div",null,c.data!=null&&h.createElement("div",null,h.createElement("div",{className:"rollout-blueprint-activator__header"},h.createElement("div",{className:"rollout-automations-list-item__icons"},h.createElement(ze,{className:"rollout-automations-list-item__trigger"},h.createElement(k,{appKey:c.data.trigger.appKey})),h.createElement(ze,{className:"rollout-automations-list-item__action"},h.createElement(k,{appKey:c.data.action.appKey}))),h.createElement("div",{className:"rollout-blueprint-activator__name"},c.data.name)),no,q(),h.createElement("div",null,y?h.createElement("button",{type:"button","aria-label":"Deactivation button",disabled:d.isLoading,className:"rollout-blueprint-activator__deactivate-btn rollout-button--primary",onClick:$t},d.isLoading?"Deactivating...":"Deactivate"):h.createElement("button",{type:"button","aria-label":"Activation button",disabled:d.isLoading,className:"rollout-blueprint-activator__activate-btn rollout-button--primary",onClick:eo},d.isLoading?"Activating...":"Activate")))))}import{matchSorter as Ue}from"match-sorter";import K,{useState as wa}from"react";import{useMutation as Oa,useTRPCContext as Ba}from"@rollouthq/api-client-react";import{isChildofInteractiveElement as Na,Center as qe,Search as Ea,TextField as $a,Spinner as Ra,Switch as La}from"@rollouthq/ui";function Po(o){let{blueprints:t,isLoading:r=!1,onOpenActivationForm:n}=o,[e,l]=wa(""),a=Ue(t,e,{keys:["name","action.app.name"],threshold:Ue.rankings.ACRONYM}),i=a.length===0;return K.createElement("div",{className:"rollout-automations-list__container"},K.createElement("div",{className:"rollout-automations-list__search-input__group"},K.createElement("div",{className:"rollout-automations-list__search-input__left-element"},K.createElement(Ea,null)),K.createElement($a,{placeholder:"Search blueprints",value:e,onChange:l,className:"rollout-automations-list__search-input"})),r&&K.createElement("div",{className:"rollout__loading_spinner_container"},K.createElement(Ra,{className:"rollout__loading_spinner"})),!r&&i&&K.createElement("div",{className:"rollout-automations-list__empty-msg"},"No blueprints found"),K.createElement("div",{className:"rollout-automations-list__list"},a.map(s=>K.createElement(Ma,{key:s.id,blueprint:s,onOpenActivationForm:()=>n(s)}))))}function Ma(o){var a;let{blueprint:t,onOpenActivationForm:r}=o,{invalidateQueries:n}=Ba(),e=Oa("blueprints.deactivateAutomation"),l=((a=t.automation)==null?void 0:a.active)??!1;return K.createElement("div",{className:"rollout-automations-list__item-wrapper"},K.createElement("div",{className:"rollout-automations-list__item",role:"group",onClick:i=>{Na(i.target)||r()}},K.createElement("div",{className:"rollout-automations-list-item__header"},K.createElement("div",{className:"rollout-automations-list-item__icons"},K.createElement(qe,{className:"rollout-automations-list-item__trigger"},K.createElement(k,{appKey:t.trigger.appKey})),K.createElement(qe,{className:"rollout-automations-list-item__action"},K.createElement(k,{appKey:t.action.appKey}))),K.createElement("div",{className:"rollout-automations-list-item__switch"},K.createElement(La,{isSelected:l,onChange:async()=>{if(l){let i=t.id;await e.mutateAsync({blueprintId:i}),n(["blueprints.get",{blueprintId:i}]),n(["blueprints.getAutomation",{blueprintId:i}]),n(["blueprints.list"])}else r()}}))),K.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}import ot,{useState as ja}from"react";import Xt from"react";import{useQuery as Va}from"@rollouthq/api-client-react";function Fo(o){let{onOpenActivationForm:t}=o,r=Va(["blueprints.list"]);return Xt.createElement("div",null,Xt.createElement("div",{className:"rollout-automations-list__header"},Xt.createElement("span",{className:"rollout-automations-list__header-title"},"My blueprints")),Xt.createElement(Po,{blueprints:r.data??[],isLoading:r.isFetching,onOpenActivationForm:t}))}import{ArrowBack as Qa}from"@rollouthq/ui";function za(){let[o,t]=ja({mode:"LIST"});return ot.createElement("div",{className:"rollout-automations-manager"},o.mode==="LIST"&&ot.createElement(Fo,{onOpenActivationForm:r=>{t({mode:"ACTIVATE",blueprintId:r.id})}}),o.mode==="ACTIVATE"&&ot.createElement(ot.Fragment,null,ot.createElement("div",{className:"rollout-automations-manager__navbar"},ot.createElement("button",{type:"button","aria-label":"Return to blueprints list button",className:"rollout-blueprints-manager__back-btn",onClick:()=>t({mode:"LIST"})},ot.createElement(Qa,{className:"rollout-automation-form__header-back__arrow"}))),ot.createElement(vo,{blueprintId:o.blueprintId})))}import We,{useState as Ua}from"react";import{useMutation as qa}from"@rollouthq/api-client-react";function Wa(o){let{renderFields:t,prefilled:r,name:n}=o,e=qa("tasks.execute"),[l,a]=Ua(()=>{var s,u;let i={};return r==null||(n&&(i.name=n),((s=r.trigger)==null?void 0:s.appKey)!=null&&(i.trigger={...r.trigger,appKey:r.trigger.appKey,inputParams:r.trigger.inputParams??{}}),((u=r.action)==null?void 0:u.appKey)!=null&&(i.action={...r.action,appKey:r.action.appKey,inputParams:r.action.inputParams??{}})),i});return We.createElement("div",{className:"rollout-automation-creator"},We.createElement(xt,{data:l,renderFields:t,onUpdate:a,onSubmit:async i=>{await e.mutateAsync(i)},mode:"task",onSave:()=>{},isSaving:e.isLoading}))}import st from"react";import{RolloutIcon as Za,st as ht}from"@rollouthq/ui";function Ya(){return st.createElement(ht.div,{css:{textAlign:"center"}},st.createElement(ht.div,{css:{display:"flex",justifyContent:"center",alignItems:"center"}},st.createElement(Za,{width:"16px"}),st.createElement(ht.span,{css:{paddingLeft:"$2",fontWeight:700,color:"$neutral-2"}},"Powered by Rollout")),st.createElement(ht.div,{css:{marginTop:"$2",fontSize:"8px",color:"$grayMedium"}},"By automating, you agree to Rollout's"," ",st.createElement(ht.a,{href:"https://docs.rollouthq.com/security-and-legal/security",css:{color:"black",textDecoration:"underline"}},"Terms")," ","&"," ",st.createElement(ht.a,{href:"https://docs.rollouthq.com/security-and-legal/privacy-policy",css:{color:"black",textDecoration:"underline"}},"Privacy policy")))}import Ze,{useContext as So,useMemo as Ye,useState as Ha,useLayoutEffect as Xa}from"react";function Do(o,t,r,n){Object.defineProperty(o,t,{get:r,set:n,enumerable:!0,configurable:!0})}var To={};Do(To,"SSRProvider",()=>ko);Do(To,"useSSRSafeId",()=>Ga);Do(To,"useIsSSR",()=>tl);var Gt={prefix:String(Math.round(Math.random()*1e10)),current:0},Jt=Ze.createContext(Gt);function ko(o){let t=So(Jt),r=Ye(()=>({prefix:t===Gt?"":`${t.prefix}-${++t.current}`,current:0}),[t]);return Ze.createElement(Jt.Provider,{value:r},o.children)}var Ja=Boolean(typeof window<"u"&&window.document&&window.document.createElement);function Ga(o){let t=So(Jt);return t===Gt&&!Ja&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server."),Ye(()=>o||`react-aria${t.prefix}-${++t.current}`,[o])}function tl(){let t=So(Jt)!==Gt,[r,n]=Ha(t);return typeof window<"u"&&t&&Xa(()=>{n(!1)},[]),r}import{BrowserClient as rl,defaultIntegrations as nl,defaultStackParser as il,makeFetchTransport as al}from"@sentry/browser";import At,{useCallback as ll,useState as sl}from"react";import{ErrorBoundary as ul}from"react-error-boundary";import{RolloutAPIClientProvider as pl}from"@rollouthq/api-client-react";import ut from"react";import{Gear as ol}from"@rollouthq/ui";import{RedQuestion as el}from"@rollouthq/ui";function He(){return ut.createElement("div",{className:"rollout-error-fallback__container"},ut.createElement("div",null,ut.createElement(ol,{style:{width:"40px",height:"40px"}}),ut.createElement(el,{style:{position:"relative",right:"10px",bottom:"30px"}})),ut.createElement("div",{className:"rollout-error-fallback__text-container"},ut.createElement("div",{className:"rollout-error-fallback__message"},"An unexpected error occured"),ut.createElement("div",{className:"rollout-error-fallback__additional-info"},"Please try again later")))}var Xe="https://app.rollouthq.com/api",ml="https://28e3dd4b02f14f2eb74768520edbc8a1@o345148.ingest.sentry.io/6463365";function dl(o){let{token:t,allowedApps:r,apiBaseUrl:n=Xe,children:e,env:l="production",onError:a}=o,[i]=sl(()=>new rl({dsn:ml,transport:al,stackParser:il,integrations:nl})),s=ll((u,m)=>{a==null||a(u,m),l==="production"&&i.captureException(u,{data:{info:m}})},[l,i,a]);return At.createElement(ul,{FallbackComponent:He,onError:s},At.createElement(Zo,{apiBaseUrl:n},At.createElement(Jo,{allowedApps:r},At.createElement(pl,{token:t,apiBaseUrl:n??Xe},At.createElement(ne,null,At.createElement(ko,null,e))))))}import{curlyTemplate as rg}from"@rollouthq/common";import{globalCss as cl}from"@rollouthq/ui";var to={border:"1px solid #D5DCE2",borderRadius:"8px",padding:"16px",marginTop:"24px",background:"white"},Gf=cl({".rollout-automation-form__line-items-container":{border:"1px solid #DFE1E4",borderRadius:"8px"},".rollout-automation-form__line-items-header":{padding:"12px",display:"flex",gap:"12px",alignItems:"flex-start",flexDirection:"column",background:"linear-gradient(180deg, rgba(255, 255, 255, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), #FFFFFF"},".rollout-automation-form__line_items-description":{fontSize:"13px"},".rollout-automation-form__line-items-title":{fontSize:"13px",fontWeight:"600"},".rollout-automation-form__line-items-content":{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},".rollout-automations-list__container":{display:"flex",flexDirection:"column"},".rollout-automations-list__header":{display:"flex",paddingY:"16px",marginBottom:"16px",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #EFF1F4"},".rollout-automations-list__header-title":{fontWeight:"600"},".rollout-error-fallback__container":{boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"32px",gap:"16px",margin:"24px auto",width:"572px",height:"173px",border:"1px solid #D5DCE2",borderRadius:"8px"},".rollout-error-fallback__text-container":{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",width:"227px",height:"48px"},".rollout-error-fallback__message":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontWeight:"600",fontSize:"16px",lineHeight:"150%"},".rollout-error-fallback__additional-info":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontweight:"500",fontSize:"13px",lineHeight:"150%"},".rollout-combobox__input__spinner":{width:"1rem",height:"1rem"},".rollout-combobox__input":{width:"100%",paddingX:"$2",paddingY:"$2-5",background:"none",outline:"none",border:"none",cursor:"text",paddingRight:"40px",fontSize:"13px","&:focus":{borderColor:"$interactPrimary"},"[data-disabled]":{opacity:.4,cursor:"not-allowed"},".rollout-combobox__input__left-element[data-icon] ~ &":{paddingLeft:"40px"},"&:disabled":{cursor:"not-allowed"}},".rollout-select__tag":{margin:"2px",paddingX:"6px",paddingY:"1px",height:"fit-content",display:"flex",alignItems:"center",gap:"4px",background:"white",border:"1px solid #EFF1F4",borderRadius:"4px",fontWeight:"500",cursor:"pointer",whiteSpace:"nowrap"},".rollout-select__tag-icon":{color:"#91959C","&:hover":{color:"black"}},".rollout-select__input":{background:"none",outline:"none",border:"none",width:"100%","&:disabled":{cursor:"not-allowed"}},".rollout-select__input__group":{background:"#F8F9FB",height:"36px",paddingX:"8px",".rollout-select__input":{paddingLeft:"0"}},".rollout-form-control__input[data-error]":{".rollout-combobox__input__group, .rollout-select__input__group, .rollout__base-input":{borderColor:"$error"}},".rollout-combobox__input__group, .rollout-select__input__group":{position:"relative",overflow:"hidden",display:"flex",alignItems:"center",fontSize:"13px",outline:"none",overflowX:"hidden",borderWidth:"1px",borderRadius:"$md",borderStyle:"solid",borderColor:"$strokeMedium","&[data-focused]":{borderColor:"$interactPrimary"},"&[data-disabled]":{cursor:"not-allowed",color:"$grayMedium",backgroundColor:"$surfaceSecondary"}},".rollout-connect-combobox__label, .rollout-connect-select__label":{marginBottom:"$2",span:{color:"$primary"}},".rollout-connect-filebrowser":{padding:"0",listStyle:"none",overflow:"auto",borderRadius:"4px"},".rollout-connect-filebrowser-back-button":{maxWidth:"100px"},".rollout-connect-filebrowser-selected-folder-display":{fontSize:"14px"},".rollout-connect-filebrowser li":{outline:"none",borderBottom:"solid 2px",borderColor:"#F8F9FB","&:hover":{background:"#F8F9FB"}},".rollout-connect-filebrowser__list-item-display":{display:"flex",flexDirection:"column",paddingLeft:"5px",fontSize:"14px"},".rollout-connect-filebrowser li[aria-selected=true]":{background:"#F4F5F8"},".rollout-connect-filebrowser [role=gridcell]":{display:"flex",alignItems:"center",gap:"4px"},".rollout-connect-filebrowser li button":{marginLeft:"auto"},".rollout-combobox__input__left-element, .rollout-combobox__input__right-element":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute","&:not([data-open])":{pointerEvents:"none"},"&[data-open]":{cursor:"pointer"},top:"50%",transform:"translateY(-50%)",zIndex:2,color:"#91959C",border:"none",background:"none"},".rollout-combobox__input__left-element":{size:"24px",left:"8px","&:not([data-icon])":{display:"none"},"[data-avatar][data-selected] &":{background:"transparent",border:"none",color:"white",fontSize:"$1"},borderWidth:"1px",borderColor:"#EFF1F4",borderStyle:"solid",borderRadius:"6px",background:"white"},".rollout-combobox__input__right-element, .rollout-select__input__right-element":{size:"16px",right:"8px"},".rollout-combobox__input__spinner, .rollout-select__input__spinner":{flexShrink:"0",size:"12px"},".rollout-combobox__content, .rollout-select__content":{maxHeight:"288px",overflowX:"hidden",overflowY:"auto",outline:"none",border:"solid 1px",borderColor:"#D5DCE2",borderRadius:"8px",".rollout-tab__list":{background:"#282A2F",padding:"10px 12px",fontSize:"13px",color:"white",fontWeight:"600",gap:"16px",border:"none"},".rollout-tabs__tab":{overflowX:"hidden !important",padding:"0",border:"none",color:"white",opacity:"0.4","&[data-selected]":{opacity:"1"}}},".rollout-select__multiple-alert":{display:"flex",alignItems:"center",gap:"8px",paddingX:"12px",paddingY:"8px",background:"#5386F6",color:"white",span:{fontSize:"13px",fontWeight:"500"}},".rollout-combobox__content ul":{margin:"0px",padding:"0px"},".rollout-select__content ul":{margin:"0px",padding:"0px"},".rollout-select__option-check__icon":{marginLeft:"auto"},".rollout-listbox":{width:"100%",margin:0,padding:0},".rollout-listbox__option, .rollout-select__option":{display:"flex",alignItems:"center",padding:"$2",fontSize:"$2",outline:"none",cursor:"pointer",borderBottom:"solid 1px",borderColor:"#F8F9FB","&[data-focused]":{background:"#F4F5F8"},"&[data-disabled]":{fontWeight:"500",color:"#91959C"},"&[data-selected]":{fontWeight:"500",color:"#5284F2",diaplay:"flex",alignItems:"center"}},"rollout-listbox__option-with-button":{padding:"0"},".rollout-listbox__option-icon":{"[data-avatar] &":{background:"#C3C7CE;",color:"white",border:"none",borderRadius:"100%",padding:0,fontSize:"$1"},borderWidth:"1px",borderColor:"$strokeMedium",borderStyle:"solid",borderRadius:"$md",background:"white",size:"$6",padding:"$1",marginRight:"$1-5"},".rollout-automations-list__search-input":{paddingX:"40px",paddingY:"10px",borderRadius:"$md",outline:"none",borderWidth:"2px",borderColor:"#EFF1F4","&:focus":{borderColor:"$interactPrimary"},borderStyle:"solid",background:"#F8F9FB"},".rollout-automations-list__search-input__group":{position:"relative",display:"flex",marginBottom:"$4",color:"#91959C"},".rollout-automations-list__search-input__left-element":{position:"absolute",left:"0px",top:"0px",zIndex:2,display:"flex",size:"40px",fontSize:"$md",alignItems:"center",justifyContent:"center",pointerEvents:"none",svg:{size:"20px"}},".rollout-automations-list__not-found":{paddingInlineStart:"$4"},".rollout-form-control-find__container":{display:"flex",background:"#e0e1e4",width:"max-content",borderRadius:"6px"},".rollout-form-control-find__active":{color:"#5d88ef",fontSize:"0.8125rem",fontFamily:"inherit",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"white",height:"32px",cursor:"pointer",borderRadius:"8px",border:"1px solid #e0e1e4"},".rollout-form-control-find__disabled":{color:"#6c6f75",fontFamily:"inherit",fontSize:"0.8125rem",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"e0e0e5",height:"32px",cursor:"pointer",borderRadius:"8px"},".rollout-automations-list__new-btn":{display:"flex",alignItems:"center",gap:"8px",padding:"4px 12px",whiteSpace:"nowrap",backgroundColor:"#5386F7",color:"white",border:"none",borderRadius:"8px",height:"32px",cursor:"pointer"},".rollout-automations-list__empty-msg":{textAlign:"center",padding:"20px",border:"1px solid #eff1f4",borderRadius:"4px"},".rollout-automations-list__error-msg":{textAlign:"center",padding:"20px",border:"1px dashed #AA4849",borderRadius:"4px"},".rollout-automations-list__list":{display:"grid",gap:"16px",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))"},".rollout-automations-list__item-wrapper":{position:"relative",marginBottom:"8px",maxWidth:"343px",border:"1px solid #D5DCE2",borderRadius:"8px","&:hover":{border:"1px solid #ADB4BA"},"&[data-deleting]":{opacity:.4},"&[data-deleting]::after":{content:"''",position:"absolute",inset:0,userSelect:"none",cursor:"wait"}},".rollout-automations-list__item":{padding:"16px",cursor:"pointer"},".rollout-automations-list-item__header":{display:"flex",alignItems:"center",justifyContent:"space-between"},".rollout-automations-list-item__draft-badge":{marginLeft:"auto",marginRight:"10px",padding:"4px 8px",borderRadius:"40px",background:"$neutral-4",fontSize:"small",color:"white"},".rollout-automations-list-item__icons":{display:"inline-flex",".rollout-automations-list-item__trigger, .rollout-automations-list-item__action":{padding:"$1",borderStyle:"solid",borderWidth:"1px",borderColor:"$strokeMedium",borderRadius:"$md",fontSize:"24px"},":first-child":{borderStartEndRadius:"unset",borderEndEndRadius:"unset",marginRight:"-1px"},":last-child":{borderStartStartRadius:"unset",borderEndStartRadius:"unset"},size:"fit-content"},".rollout-automations-list-item__name":{marginTop:"12px",fontSize:"16px",fontWeight:"600",color:"#31373F",height:"72px"},".rollout-automations-list-item__options__trigger":{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",cursor:"pointer",color:"#91959C",transition:"all .2s ease",size:"32px",svg:{size:"16px"},"&:hover":{bg:"rgba(219, 97, 92, 0.1)",color:"#DB615C"},opacity:0,'[role="group"]:hover:not([data-open]) &':{opacity:1}},".rollout-automations-list-item__options__content":{position:"absolute",padding:"18px 16px",inset:"0",background:"white",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"12px",justifyContent:"center",alignItems:"center",span:{fontWeight:"600"}},".rollout-automations-list-item__options__delete-item-btn":{background:"#DB615C",color:"white",whiteSpace:"nowrap","&:hover":{background:"#C74D48"},cursor:"pointer"},".rollout-automations-list-item__options__cancel-item-btn":{border:"1px solid #282A2F",cursor:"pointer"},".rollout-automations-manager__navbar":{paddingY:"$3"},".rollout-automations-manager__back-btn":{border:"none",background:"none"},".rollout-automation-form__header-back__arrow":{cursor:"pointer"},".rollout-automations-list-item__options__content button":{fonSize:"13px",fontWeight:"500",borderRadius:"8px",height:"32px",width:"100%",cursor:"pointer",transition:"all .2s ease"},".rollout-automation-form__name":{height:"36px",fontWeight:500,fontSize:"13px",background:"none",border:"1px solid",borderColor:"$strokeDark",borderRadius:"8px",paddingX:"$4",paddingY:"$2-5",outline:"none","&[aria-invalid]::placeholder":{color:"$error"}},".rollout-automation-form__action-inputs-wrapper, .rollout-automation-form__trigger-inputs-wrapper":{display:"flex",flexDirection:"column",gap:"$3"},".rollout-automation-form__trigger":{...to},".rollout-automation-form__trigger-inputs":{...to},".rollout-automation-form__action":{...to},".rollout-automation-form__action-inputs":{...to},".rollout-automation-form__trigger-trigger":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__trigger-app ":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__credentials":{marginTop:"$3"},".rollout-automation-form__action .rollout-automation-form__action-app":{marginBottom:"$3"},".rollout-automation-form__action .rollout-automation-form__action-action":{marginBottom:"$3"},".rollout-automation-form__credential":{marginBottom:"$3"},".rollout-automation-form__label":{fontWeight:"600",marginBottom:"12px"},".rollout-automation-form__helper-text":{marginBottom:"12px"},".rollout-automation-form__content":{marginBottom:"16px"},".rollout-automation-form-oauth__error__message":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-input":{height:"36px",paddingX:"$2",paddingY:"$2-5",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"6px"},".rollout-button--primary, .rollout-button--secondary, .rollout-button--danger":{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",height:"32px",padding:"4px 12px",fontWeight:600,whiteSpace:"nowrap",textAlign:"center",border:"1px solid",borderRadius:"8px"},".rollout-button--primary":{backgroundColor:"#5386F7",borderColor:"#5386F7",color:"white"},".rollout-button--secondary":{backgroundColor:"$grayMedium",borderColor:"$grayMedium",color:"white"},".rollout-button--danger":{color:"white",backgroundColor:"$error",borderColor:"$error","&:hover":{backgroundColor:"#A92F2A",borderColor:"#A92F2A"}},".rollout-automation-form__buttons":{display:"flex",gap:"$3"},".rollout-automation-form__cancel":{marginLeft:"auto"},".rollout-automation-form__delete":{position:"relative",marginLeft:"auto",".rollout-automation-form__cancel ~ &":{marginLeft:"0"}},".rollout-automation-form-delete__confirm-dialog":{position:"absolute",bottom:"100%",right:"0",whiteSpace:"nowrap",background:"white",marginBottom:"12px",padding:"12px",border:"1px solid #F8F9FB",borderRadius:"8px",boxShadow:"0px 4px 16px rgba(0, 0, 0, 0.2)"},".rollout-automation-form__delete-confirm-text":{padding:"$3",fontSize:"$2",fontWeight:500},".rollout-automation-form__delete-confirm-buttons":{display:"flex",justifyContent:"space-between",gap:"$3",marginTop:"$4"},".rollout-automation-form__delete-cancel, .rollout-automation-form__delete-confirm":{width:"100%"},".rollout-automation-form__submit[disabled], .rollout-automation-form__submit[data-loading]":{opacity:.3},".rollout-form-control__label":{marginBottom:"8px",fontSize:"$2",fontWeight:500,display:"flex",alignItems:"center"},".rollout-form-control__lock-btn":{marginLeft:"auto",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #EFF1F4",size:"20px",cursor:"pointer",borderRadius:"4px",boxShadow:"$md",color:"#91959C",transition:"all .2s ease","&[data-locked]":{color:"#9A58F6"},"&:hover":{background:"#F8F9FB"},svg:{height:"14px"}},".rollout-form-control__required-hint":{paddingLeft:"4px",color:"$primary"},".rollout-form-control__description":{marginBottom:"8px",fontSize:"13px"},".rollout-form-control__error":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-automation-form__api-token-input":{height:"32px",marginTop:"$2",marginBottom:"$4",background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},".rollout-automation-form__api-token-input-info":{fontSize:"0.75rem",marginBottom:"$1-5",color:"#6C6F75"},".rollout-automation-form__api-token-input-label":{fontSize:"$2",marginTop:"$1-5"},".rollout-automation-form__api-token-input-container":{marginTop:"$2"},".rollout-automation-form__api-token-connection-result":{fontSize:".85rem"},".rollout-automation-form__api-token-apitoken-button-container":{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"$2-5"},".rollout-blueprint-activator__header":{display:"flex",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"$strokeMedium",paddingY:"12px"},".rollout-blueprint-activator__name":{marginLeft:"16px"},".rollout-blueprint-activator__label":{padding:"12px",fontSize:"$3",fontWeight:"bold",borderBottom:"1px solid",borderBottomColor:"$strokeMedium"},".rollout-blueprint-activator__trigger":{marginTop:"12px",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"8px","& .rollout-automation-form__credentials":{marginBottom:"$3"}},".rollout-blueprint-activator__trigger__fields":{padding:"12px"},".rollout-blueprint-activator__activate-btn, .rollout-blueprint-activator__deactivate-btn":{marginTop:"12px"},".rollout__loading_spinner_container":{padding:"1rem",display:"flex",justifyContent:"center"},".rollout__loading_spinner":{height:"1rem",width:"1rem"},".rollout__base-input":{background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},"input.rollout__base-input, select.rollout__base-input":{height:"32px"},".rollout__terms-of-service-link, .rollout__privacy-policy-link":{color:"#31373F",textDecoration:"underline","&:hover":{color:"#1e2227"}},".ace_editor":{backgroundColor:"$surfaceSecondary"},".rollout-card":{display:"flex",flexDirection:"column",gap:"12px",marginTop:"12px",padding:"16px",border:"1px solid #d5dce2",borderRadius:"8px"}});export{Co as AutomationCreator,ho as AutomationEditor,Fa as AutomationsManager,vo as BlueprintActivator,Po as BlueprintsList,za as BlueprintsManager,Ao as MyAutomations,Fo as MyBlueprints,Ya as PoweredByRollout,dl as RolloutConnectProvider,Wa as TaskInitiator,Je as components,rg as curlyTemplate,Gf as defaultTheme};
//# sourceMappingURL=index.esm.js.map